<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒãƒ³ã‚·ãƒ§ãƒ³è²·å–æ‰¿èªã‚·ã‚¹ãƒ†ãƒ  - BI Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  /* ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼ */
  --bg-dark: #1a1a2e;
  --bg-card: #252540;
  --bg-card-hover: #2d2d4a;
  --border: #3a3a55;
  --text: #e8e8f0;
  --text-muted: #8888a8;
  
  /* ãƒã‚ªãƒ³ã‚«ãƒ©ãƒ¼ */
  --neon-pink: #ff3e9d;
  --neon-green: #00ff88;
  --neon-pink-glow: rgba(255, 62, 157, 0.4);
  --neon-green-glow: rgba(0, 255, 136, 0.4);
  
  /* è£œåŠ©è‰² */
  --warning: #ffaa00;
  --info: #00d4ff;
  --danger: #ff3e9d;
  --success: #00ff88;
  --accent: #00ff88;
  --primary: #252540;
  --primary-light: #2d2d4a;
  
  /* ã‚·ãƒ£ãƒ‰ã‚¦ */
  --shadow: 0 4px 6px -1px rgba(0,0,0,0.3);
  --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.4);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
  font-family: 'Noto Sans JP', sans-serif; 
  background: var(--bg-dark); 
  color: var(--text); 
  line-height: 1.6; 
}

.container { max-width: 1400px; margin: 0 auto; padding: 20px; }

/* Header */
header { 
  background: var(--bg-card);
  border: 1px solid var(--border);
  color: var(--text); 
  padding: 20px 30px; 
  border-radius: 16px; 
  margin-bottom: 24px; 
  display: flex; 
  justify-content: space-between; 
  align-items: center;
  box-shadow: var(--shadow-lg);
}
header h1 { 
  font-size: 1.5rem; 
  font-weight: 600; 
  display: flex; 
  align-items: center; 
  gap: 10px;
  background: linear-gradient(90deg, var(--neon-pink), var(--neon-green));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.user-info { display: flex; align-items: center; gap: 12px; font-size: 0.9rem; color: var(--text-muted); }
.user-info span { background: rgba(255,255,255,0.05); border: 1px solid var(--border); padding: 8px 16px; border-radius: 24px; }

/* Tabs */
.tabs { display: flex; gap: 8px; margin-bottom: 24px; background: var(--bg-card); border: 1px solid var(--border); padding: 8px; border-radius: 12px; box-shadow: var(--shadow); }
.tab { padding: 12px 24px; background: transparent; border: 1px solid transparent; border-radius: 8px; cursor: pointer; font-size: 0.95rem; color: var(--text-muted); font-weight: 500; transition: all 0.3s; }
.tab:hover { background: var(--bg-card-hover); border-color: var(--border); color: var(--text); }
.tab.active { background: transparent; border-color: var(--neon-green); color: var(--neon-green); box-shadow: 0 0 15px var(--neon-green-glow); }
.badge { background: var(--neon-pink); color: #fff; font-size: 0.75rem; padding: 2px 8px; border-radius: 10px; margin-left: 6px; box-shadow: 0 0 10px var(--neon-pink-glow); }

/* Period Filter */
.period-filter { 
  display: flex; 
  gap: 8px; 
  margin-bottom: 20px; 
  padding: 16px 20px; 
  background: var(--bg-card); 
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow);
  align-items: center;
}
.period-filter label { font-weight: 600; color: var(--text-muted); margin-right: 12px; }
.period-btn { 
  padding: 8px 16px; 
  border: 1px solid var(--border); 
  border-radius: 8px; 
  background: transparent; 
  color: var(--text-muted);
  cursor: pointer; 
  font-size: 0.85rem; 
  font-weight: 500;
  transition: all 0.3s;
}
.period-btn:hover { border-color: var(--neon-green); color: var(--neon-green); }
.period-btn.active { background: transparent; border-color: var(--neon-green); color: var(--neon-green); box-shadow: 0 0 15px var(--neon-green-glow); }
.date-range { margin-left: auto; display: flex; align-items: center; gap: 8px; color: var(--text-muted); }
.date-range input { padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 0.85rem; background: var(--bg-dark); color: var(--text); }

/* KPI Cards */
.kpi-grid { 
  display: grid; 
  grid-template-columns: repeat(5, 1fr); 
  gap: 16px; 
  margin-bottom: 24px; 
}
.kpi-card { 
  background: var(--bg-card); 
  border: 1px solid var(--border);
  border-radius: 16px; 
  padding: 20px; 
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
  transition: all 0.3s;
}
.kpi-card:hover { 
  transform: translateY(-4px); 
  border-color: var(--neon-pink);
  box-shadow: 0 0 25px var(--neon-pink-glow);
}
.kpi-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--neon-pink), var(--neon-green));
}
.kpi-card.blue::before { background: var(--info); box-shadow: 0 0 10px rgba(0, 212, 255, 0.5); }
.kpi-card.green::before { background: var(--neon-green); box-shadow: 0 0 10px var(--neon-green-glow); }
.kpi-card.orange::before { background: var(--warning); box-shadow: 0 0 10px rgba(255, 170, 0, 0.5); }
.kpi-card.red::before { background: var(--neon-pink); box-shadow: 0 0 10px var(--neon-pink-glow); }
.kpi-card.purple::before { background: #a855f7; box-shadow: 0 0 10px rgba(168, 85, 247, 0.5); }
.kpi-label { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 8px; font-weight: 500; }
.kpi-value { font-size: 1.8rem; font-weight: 700; color: var(--neon-pink); text-shadow: 0 0 20px var(--neon-pink-glow); }
.kpi-value.green { color: var(--neon-green); text-shadow: 0 0 20px var(--neon-green-glow); }
.kpi-change { display: flex; align-items: center; gap: 4px; font-size: 0.8rem; margin-top: 8px; }
.kpi-change.up { color: var(--neon-green); }
.kpi-change.down { color: var(--neon-pink); }
.kpi-target { font-size: 0.75rem; color: var(--text-muted); margin-top: 4px; }
.kpi-progress { 
  height: 6px; 
  background: var(--border); 
  border-radius: 3px; 
  margin-top: 8px; 
  overflow: hidden;
}
.kpi-progress-bar { height: 100%; border-radius: 3px; transition: width 0.5s ease; background: linear-gradient(90deg, var(--neon-green), var(--neon-pink)); box-shadow: 0 0 10px var(--neon-green-glow); }

/* Cards */
.card { 
  background: var(--bg-card); 
  border: 1px solid var(--border);
  border-radius: 16px; 
  padding: 24px; 
  margin-bottom: 20px; 
  box-shadow: var(--shadow); 
}
.card-header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  margin-bottom: 20px; 
  padding-bottom: 16px; 
  border-bottom: 1px solid var(--border); 
}
.card-title { 
  font-size: 1rem; 
  font-weight: 600; 
  color: var(--text); 
  display: flex; 
  align-items: center; 
  gap: 8px;
}
.card-title::before {
  content: '';
  width: 4px;
  height: 18px;
  background: linear-gradient(180deg, var(--neon-pink), var(--neon-green));
  border-radius: 2px;
}
.card-actions { display: flex; gap: 8px; }
.card-action-btn { 
  padding: 6px 12px; 
  border: 1px solid var(--border); 
  border-radius: 6px; 
  background: transparent;
  color: var(--text-muted);
  font-size: 0.8rem; 
  cursor: pointer;
  transition: all 0.3s;
}
.card-action-btn:hover { border-color: var(--neon-green); color: var(--neon-green); box-shadow: 0 0 10px var(--neon-green-glow); }

/* Grid Layout */
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }

/* Charts */
.chart-container { position: relative; }
.bar-chart { display: flex; align-items: flex-end; height: 200px; gap: 12px; padding: 20px 10px 10px; }
.bar-group { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; }
.bar-wrapper { width: 100%; display: flex; gap: 4px; justify-content: center; align-items: flex-end; height: 160px; }
.bar { 
  width: 24px; 
  border-radius: 6px 6px 0 0; 
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
}
.bar:hover { filter: brightness(1.2); transform: scaleY(1.05); transform-origin: bottom; }
.bar.purchase { background: linear-gradient(180deg, var(--neon-pink) 0%, #cc3280 100%); box-shadow: 0 0 10px var(--neon-pink-glow); }
.bar.sales { background: linear-gradient(180deg, var(--neon-green) 0%, #00cc6a 100%); box-shadow: 0 0 10px var(--neon-green-glow); }
.bar-label { font-size: 0.8rem; color: var(--text-muted); font-weight: 500; }
.chart-legend { display: flex; justify-content: center; gap: 24px; margin-top: 16px; }
.legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.8rem; color: var(--text-muted); }
.legend-dot { width: 12px; height: 12px; border-radius: 3px; }

/* Donut Chart */
.donut-chart-container { display: flex; align-items: center; gap: 24px; padding: 10px; }
.donut-chart { position: relative; width: 160px; height: 160px; }
.donut-chart svg { transform: rotate(-90deg); filter: drop-shadow(0 0 10px var(--neon-green-glow)); }
.donut-center { 
  position: absolute; 
  top: 50%; 
  left: 50%; 
  transform: translate(-50%, -50%); 
  text-align: center; 
}
.donut-center-value { font-size: 1.5rem; font-weight: 700; color: var(--neon-green); text-shadow: 0 0 15px var(--neon-green-glow); }
.donut-center-label { font-size: 0.75rem; color: var(--text-muted); }
.donut-legend { flex: 1; }
.donut-legend-item { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  padding: 10px 12px; 
  border-radius: 8px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: background 0.2s;
}
.donut-legend-item:hover { background: var(--bg-card-hover); }
.donut-legend-left { display: flex; align-items: center; gap: 10px; }
.donut-legend-dot { width: 12px; height: 12px; border-radius: 4px; }
.donut-legend-label { font-size: 0.85rem; color: var(--text); }
.donut-legend-value { font-weight: 600; color: var(--text); }

/* Horizontal Bar Chart */
.h-bar-chart { padding: 10px 0; }
.h-bar-item { margin-bottom: 16px; }
.h-bar-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
.h-bar-label { font-size: 0.85rem; color: var(--text); }
.h-bar-value { font-size: 0.85rem; font-weight: 600; color: var(--text); }
.h-bar-track { height: 24px; background: var(--border); border-radius: 12px; overflow: hidden; position: relative; }
.h-bar-fill { 
  height: 100%; 
  border-radius: 12px; 
  transition: width 0.5s ease;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding-right: 10px;
  font-size: 0.75rem;
  color: #fff;
  font-weight: 600;
}

/* Filter Buttons */
.filter-btn {
  padding: 8px 16px;
  border: 1px solid var(--border);
  border-radius: 20px;
  background: transparent;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-muted);
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}
.filter-btn:hover {
  border-color: var(--neon-green);
  color: var(--neon-green);
}
.filter-btn.active {
  background: rgba(0, 255, 136, 0.15);
  border-color: var(--neon-green);
  color: var(--neon-green);
  box-shadow: 0 0 10px var(--neon-green-glow);
}
.filter-btn.selected {
  background: rgba(255, 62, 157, 0.15);
  border-color: var(--neon-pink);
  color: var(--neon-pink);
  box-shadow: 0 0 10px var(--neon-pink-glow);
}
.filter-count {
  font-size: 0.75rem;
  opacity: 0.8;
  margin-left: 2px;
}

/* Schedule Dropdown */
.schedule-row {
  display: none;
}
.schedule-row.visible {
  display: table-row;
}
.schedule-cell {
  padding: 0 !important;
  background: var(--bg-dark);
  border-top: none !important;
}
.schedule-content {
  padding: 20px 24px;
  animation: slideDown 0.3s ease;
}
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Timeline */
.timeline {
  display: flex;
  justify-content: space-between;
  position: relative;
  padding: 20px 0;
}
.timeline::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--border);
  transform: translateY(-50%);
  z-index: 0;
}
.timeline-progress {
  position: absolute;
  top: 50%;
  left: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--neon-green), var(--neon-pink));
  transform: translateY(-50%);
  z-index: 1;
  transition: width 0.5s ease;
  box-shadow: 0 0 10px var(--neon-green-glow);
}
.timeline-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 2;
  flex: 1;
}
.timeline-dot {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: var(--border);
  border: 3px solid var(--bg-card);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  color: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  transition: all 0.3s;
}
.timeline-item.completed .timeline-dot {
  background: var(--neon-green);
  box-shadow: 0 0 15px var(--neon-green-glow);
}
.timeline-item.current .timeline-dot {
  background: var(--neon-pink);
  transform: scale(1.2);
  box-shadow: 0 0 20px var(--neon-pink-glow);
}
.timeline-item.pending .timeline-dot {
  background: var(--border);
}
.timeline-label {
  margin-top: 10px;
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--text-muted);
  text-align: center;
  white-space: nowrap;
}
.timeline-item.completed .timeline-label {
  color: var(--success);
}
.timeline-item.current .timeline-label {
  color: var(--accent);
  font-weight: 700;
}
.timeline-date {
  font-size: 0.65rem;
  color: var(--text-muted);
  margin-top: 4px;
}
.timeline-item.completed .timeline-date,
.timeline-item.current .timeline-date {
  color: var(--text);
}

/* Schedule Info */
.schedule-info {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px dashed var(--border);
}
.schedule-info-item {
  text-align: center;
  padding: 12px;
  background: #fff;
  border-radius: 8px;
}
.schedule-info-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-bottom: 4px;
}
.schedule-info-value {
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text);
}

/* Phase Divider */
.phase-divider {
  display: flex;
  align-items: center;
  margin: 16px 0 8px;
}
.phase-divider-line {
  flex: 1;
  height: 1px;
  background: var(--border);
}
.phase-divider-text {
  padding: 4px 12px;
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--text-muted);
  background: var(--bg-card);
  border-radius: 10px;
  border: 1px solid var(--border);
}

/* Property Row Clickable */
.property-row {
  cursor: pointer;
  transition: all 0.2s;
}
.property-row:hover {
  background: var(--bg-card-hover) !important;
}
.property-row.expanded {
  background: rgba(0, 255, 136, 0.05) !important;
  border-left: 2px solid var(--neon-green);
}
.expand-cell {
  width: 30px;
  text-align: center;
}
.expand-icon {
  display: inline-block;
  font-size: 0.7rem;
  color: var(--text-muted);
  transition: transform 0.2s;
}
.property-row.expanded .expand-icon {
  transform: rotate(90deg);
  color: var(--neon-green);
}

/* Schedule Detail Row */
.schedule-row {
  display: none;
}
.schedule-row.visible {
  display: table-row;
}
.schedule-row td {
  padding: 0 !important;
  background: var(--bg-dark);
}
.schedule-container {
  padding: 24px 32px;
  animation: slideDown 0.3s ease;
}
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Schedule Timeline */
.schedule-timeline {
  display: flex;
  justify-content: space-between;
  position: relative;
  padding: 0 10px;
}
.schedule-timeline::before {
  content: '';
  position: absolute;
  top: 20px;
  left: 30px;
  right: 30px;
  height: 4px;
  background: var(--border);
  z-index: 0;
}
.schedule-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 1;
  min-width: 80px;
}
.schedule-step-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  margin-bottom: 8px;
  border: 3px solid var(--border);
  background: #fff;
  transition: all 0.3s;
}
.schedule-step.completed .schedule-step-icon {
  background: var(--success);
  border-color: var(--success);
  color: #fff;
}
.schedule-step.current .schedule-step-icon {
  background: var(--accent);
  border-color: var(--accent);
  color: #fff;
  box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.2);
  animation: pulse 2s infinite;
}
.schedule-step.pending .schedule-step-icon {
  background: #fff;
  border-color: var(--border);
  color: var(--text-muted);
}
@keyframes pulse {
  0%, 100% { box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.2); }
  50% { box-shadow: 0 0 0 8px rgba(14, 165, 233, 0.1); }
}
.schedule-step-label {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-muted);
  text-align: center;
  white-space: nowrap;
}
.schedule-step.completed .schedule-step-label {
  color: var(--success);
}
.schedule-step.current .schedule-step-label {
  color: var(--accent);
}
.schedule-step-date {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: 4px;
}
.schedule-step.completed .schedule-step-date,
.schedule-step.current .schedule-step-date {
  color: var(--text);
}

/* Schedule Section Dividers */
.schedule-sections {
  display: flex;
  margin-bottom: 12px;
  gap: 8px;
}
.schedule-section-label {
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 0.7rem;
  font-weight: 600;
}
.schedule-section-label.buy {
  background: #dbeafe;
  color: #1e40af;
}
.schedule-section-label.reno {
  background: #fef3c7;
  color: #92400e;
}
.schedule-section-label.sell {
  background: #d1fae5;
  color: #065f46;
}

/* Property Row Clickable */
#propertyBody tr {
  cursor: pointer;
  transition: background 0.2s;
}
#propertyBody tr:hover {
  background: var(--bg-card-hover) !important;
}
#propertyBody tr.expanded {
  background: rgba(0, 255, 136, 0.05) !important;
}

/* Timeline Dropdown */
.timeline-row {
  display: none;
}
.timeline-row.show {
  display: table-row;
}
.timeline-row td {
  padding: 0 !important;
  background: var(--bg-dark);
  border-top: none !important;
}
.timeline-container {
  padding: 24px 32px;
  animation: slideDown 0.3s ease;
}
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Timeline */
.timeline {
  display: flex;
  justify-content: space-between;
  position: relative;
  padding: 0 10px;
}
.timeline::before {
  content: '';
  position: absolute;
  top: 20px;
  left: 40px;
  right: 40px;
  height: 4px;
  background: var(--border);
  z-index: 0;
}
.timeline-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 1;
  flex: 1;
  max-width: 100px;
}
.timeline-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  margin-bottom: 8px;
  border: 3px solid var(--border);
  background: var(--bg-card);
  transition: all 0.3s;
}
.timeline-item.completed .timeline-icon {
  background: var(--neon-green);
  border-color: var(--neon-green);
  color: #fff;
  box-shadow: 0 0 15px var(--neon-green-glow);
}
.timeline-item.current .timeline-icon {
  background: var(--neon-pink);
  border-color: var(--neon-pink);
  color: #fff;
  box-shadow: 0 0 20px var(--neon-pink-glow);
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0%, 100% { box-shadow: 0 0 15px var(--neon-pink-glow); }
  50% { box-shadow: 0 0 25px var(--neon-pink-glow); }
}
.timeline-item.pending .timeline-icon {
  background: var(--bg-card);
  border-color: var(--border);
  color: var(--text-muted);
}
.timeline-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  text-align: center;
  font-weight: 500;
}
.timeline-item.completed .timeline-label,
.timeline-item.current .timeline-label {
  color: var(--text);
  font-weight: 600;
}
.timeline-date {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: 4px;
}
.timeline-section-label {
  position: absolute;
  top: -28px;
  font-size: 0.7rem;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 4px;
  white-space: nowrap;
}
.section-purchase {
  background: rgba(0, 212, 255, 0.2);
  color: var(--info);
  border: 1px solid var(--info);
}
.section-renovation {
  background: rgba(255, 170, 0, 0.2);
  color: var(--warning);
  border: 1px solid var(--warning);
}
.section-sale {
  background: rgba(0, 255, 136, 0.2);
  color: var(--neon-green);
  border: 1px solid var(--neon-green);
}

/* Heatmap */
.heatmap { display: grid; gap: 4px; }
.heatmap-row { display: flex; gap: 4px; align-items: center; }
.heatmap-label { width: 80px; font-size: 0.8rem; color: var(--text-muted); text-align: right; padding-right: 12px; }
.heatmap-cell { 
  flex: 1; 
  height: 40px; 
  border-radius: 6px; 
  display: flex; 
  align-items: center; 
  justify-content: center;
  font-size: 0.8rem;
  font-weight: 600;
  color: #fff;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}
.heatmap-cell:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(255,255,255,0.2); z-index: 1; }
.heatmap-header { display: flex; gap: 4px; margin-bottom: 8px; padding-left: 92px; }
.heatmap-header span { flex: 1; text-align: center; font-size: 0.75rem; color: var(--text-muted); font-weight: 500; }

/* Risk Alerts */
.alert-list { }
.alert-item { 
  display: flex; 
  align-items: center; 
  gap: 16px; 
  padding: 16px; 
  border-radius: 12px; 
  margin-bottom: 12px;
  border-left: 4px solid;
  transition: transform 0.2s;
  cursor: pointer;
  background: var(--bg-card);
}
.alert-item:hover { transform: translateX(4px); }
.alert-item.critical { background: rgba(255, 62, 157, 0.1); border-color: var(--neon-pink); }
.alert-item.warning { background: rgba(255, 170, 0, 0.1); border-color: var(--warning); }
.alert-item.info { background: rgba(0, 212, 255, 0.1); border-color: var(--info); }
.alert-icon { 
  width: 40px; 
  height: 40px; 
  border-radius: 10px; 
  display: flex; 
  align-items: center; 
  justify-content: center;
  font-size: 1.2rem;
}
.alert-item.critical .alert-icon { background: rgba(255, 62, 157, 0.2); }
.alert-item.warning .alert-icon { background: rgba(255, 170, 0, 0.2); }
.alert-item.info .alert-icon { background: rgba(0, 212, 255, 0.2); }
.alert-content { flex: 1; }
.alert-title { font-weight: 600; font-size: 0.9rem; margin-bottom: 2px; }
.alert-item.critical .alert-title { color: var(--neon-pink); }
.alert-item.warning .alert-title { color: var(--warning); }
.alert-item.info .alert-title { color: var(--info); }
.alert-desc { font-size: 0.8rem; color: var(--text-muted); }
.alert-action { 
  padding: 8px 16px; 
  border-radius: 8px; 
  font-size: 0.8rem; 
  font-weight: 500;
  border: none;
  cursor: pointer;
  transition: all 0.2s;
}
.alert-item.critical .alert-action { background: var(--neon-pink); color: #fff; box-shadow: 0 0 10px var(--neon-pink-glow); }
.alert-item.warning .alert-action { background: var(--warning); color: #fff; box-shadow: 0 0 10px rgba(255, 170, 0, 0.4); }
.alert-item.info .alert-action { background: var(--info); color: #fff; box-shadow: 0 0 10px rgba(0, 212, 255, 0.4); }

/* Data Table */
table { width: 100%; border-collapse: collapse; }
th, td { padding: 14px 16px; text-align: left; border-bottom: 1px solid var(--border); }
th { background: var(--bg-dark); font-weight: 600; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
td { font-size: 0.85rem; }
tr:hover { background: var(--bg-card-hover); }
.price-cell { font-weight: 600; color: var(--neon-pink); text-shadow: 0 0 10px var(--neon-pink-glow); }
.profit-cell { font-weight: 600; color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green-glow); }
.status-tag { 
  display: inline-block; 
  padding: 4px 12px; 
  border-radius: 20px; 
  font-size: 0.75rem; 
  font-weight: 600;
  border: 1px solid;
}
.status-reno { background: rgba(255, 170, 0, 0.15); color: var(--warning); border-color: var(--warning); }
.status-sale { background: rgba(0, 255, 136, 0.15); color: var(--neon-green); border-color: var(--neon-green); box-shadow: 0 0 10px rgba(0, 255, 136, 0.2); }
.status-nego { background: rgba(255, 62, 157, 0.15); color: var(--neon-pink); border-color: var(--neon-pink); box-shadow: 0 0 10px rgba(255, 62, 157, 0.2); }
.status-long { background: rgba(255, 62, 157, 0.25); color: #ff6b6b; border-color: #ff6b6b; }
.status-wait { background: rgba(0, 212, 255, 0.15); color: var(--info); border-color: var(--info); }
.status-done { background: rgba(136, 136, 168, 0.15); color: var(--text-muted); border-color: var(--text-muted); }

/* Filter Buttons (table section) */
.filter-btn {
  padding: 8px 16px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: transparent;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}
.filter-btn:hover {
  border-color: var(--neon-green);
  color: var(--neon-green);
}
.filter-btn.active {
  background: rgba(0, 255, 136, 0.15);
  border-color: var(--neon-green);
  color: var(--neon-green);
  box-shadow: 0 0 10px var(--neon-green-glow);
}
.filter-btn.selected {
  background: rgba(255, 62, 157, 0.15);
  border-color: var(--neon-pink);
  color: var(--neon-pink);
  box-shadow: 0 0 10px var(--neon-pink-glow);
}
.filter-count {
  background: rgba(255,255,255,0.1);
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 0.75rem;
}
.filter-btn.active .filter-count,
.filter-btn.selected .filter-count {
  background: rgba(255,255,255,0.2);
}

/* Line Chart */
.line-chart-container { position: relative; height: 200px; padding: 20px 0; }
.line-chart { width: 100%; height: 100%; }
.line-chart-grid { stroke: var(--border); stroke-width: 1; }
.line-chart-line { fill: none; stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; }
.line-chart-area { opacity: 0.1; }
.line-chart-dot { cursor: pointer; transition: r 0.2s; }
.line-chart-dot:hover { r: 8; }
.line-chart-labels { display: flex; justify-content: space-between; padding: 10px 20px 0; }
.line-chart-labels span { font-size: 0.75rem; color: var(--text-muted); }

/* Gauge Chart */
.gauge-container { display: flex; justify-content: center; padding: 20px; }
.gauge { position: relative; width: 180px; height: 100px; }
.gauge-bg { fill: none; stroke: var(--bg); stroke-width: 20; }
.gauge-fill { fill: none; stroke-width: 20; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
.gauge-center { 
  position: absolute; 
  bottom: 0; 
  left: 50%; 
  transform: translateX(-50%); 
  text-align: center; 
}
.gauge-value { font-size: 2rem; font-weight: 700; }
.gauge-label { font-size: 0.8rem; color: var(--text-muted); }

/* Mini Sparkline */
.sparkline { display: flex; align-items: flex-end; gap: 2px; height: 30px; }
.sparkline-bar { 
  flex: 1; 
  background: var(--accent); 
  border-radius: 2px; 
  opacity: 0.6;
  transition: opacity 0.2s;
}
.sparkline-bar:last-child { opacity: 1; }

/* Tooltip */
.tooltip {
  position: absolute;
  background: var(--bg-card);
  color: var(--text);
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 0.8rem;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 1000;
  white-space: nowrap;
  border: 1px solid var(--border);
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
}
.tooltip.visible { opacity: 1; }

/* Animations */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-in { animation: fadeInUp 0.5s ease forwards; }
.delay-1 { animation-delay: 0.1s; }
.delay-2 { animation-delay: 0.2s; }
.delay-3 { animation-delay: 0.3s; }
.delay-4 { animation-delay: 0.4s; }

/* Responsive */

/* iPad Pro 12.9" and larger tablets (landscape) */
@media (max-width: 1366px) {
  .container { padding: 16px; }
  .kpi-grid { grid-template-columns: repeat(5, 1fr); gap: 12px; }
}

/* iPad Pro 11" / iPad Air (landscape) */
@media (max-width: 1200px) { 
  .kpi-grid { grid-template-columns: repeat(3, 1fr); }
  .grid-2, .grid-3 { grid-template-columns: 1fr; }
}

/* iPad (portrait) and iPad mini */
@media (max-width: 1024px) {
  .container { padding: 12px; }
  
  header { 
    flex-direction: column; 
    gap: 12px; 
    text-align: center;
    padding: 16px 20px;
  }
  header h1 { font-size: 1.3rem; }
  .user-info { justify-content: center; }
  
  .tabs { 
    flex-wrap: wrap; 
    gap: 6px;
  }
  .tab { 
    padding: 10px 16px; 
    font-size: 0.85rem;
    flex: 1 1 auto;
    min-width: 100px;
    text-align: center;
  }
  
  .period-filter {
    flex-wrap: wrap;
    gap: 8px;
  }
  .period-btn {
    padding: 10px 14px;
    font-size: 0.85rem;
  }
  .date-range {
    margin-left: 0;
    margin-top: 8px;
    width: 100%;
    justify-content: center;
  }
  
  .kpi-grid { 
    grid-template-columns: repeat(3, 1fr); 
    gap: 10px;
  }
  .kpi-card { padding: 16px; }
  .kpi-value { font-size: 1.6rem; }
  
  .card { padding: 16px; }
  .card-header { 
    flex-direction: column; 
    gap: 12px; 
    align-items: flex-start;
  }
  .card-actions {
    width: 100%;
    flex-wrap: wrap;
    gap: 8px;
  }
  
  /* Filter buttons for iPad */
  .filter-btn {
    padding: 10px 14px;
    font-size: 0.85rem;
    min-height: 44px; /* iOS touch target */
  }
  
  /* Property table adjustments */
  #propertyTable {
    font-size: 0.8rem;
  }
  #propertyTable th,
  #propertyTable td {
    padding: 10px 8px;
  }
  
  /* Summary grid */
  #propertySummary {
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 8px;
  }
  #propertySummary > div:nth-child(4),
  #propertySummary > div:nth-child(5) {
    grid-column: span 1;
  }
  
  /* Timeline adjustments */
  .timeline-container {
    padding: 16px 20px;
  }
  .timeline-icon {
    width: 36px;
    height: 36px;
    font-size: 0.9rem;
  }
  .timeline-label {
    font-size: 0.7rem;
  }
  .timeline-date {
    font-size: 0.65rem;
  }
}

/* iPad mini and smaller tablets (portrait) */
@media (max-width: 768px) { 
  .kpi-grid { grid-template-columns: repeat(2, 1fr); }
  .period-filter { flex-wrap: wrap; }
  .date-range { margin-left: 0; margin-top: 12px; width: 100%; }
  
  header h1 { font-size: 1.2rem; }
  
  .tabs {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    flex-wrap: nowrap;
    padding-bottom: 4px;
  }
  .tab {
    flex-shrink: 0;
    min-width: 90px;
  }
  
  /* Table horizontal scroll */
  #propertyTable {
    font-size: 0.75rem;
  }
  #propertyTable th,
  #propertyTable td {
    padding: 8px 6px;
    white-space: nowrap;
  }
  
  /* Summary 2 columns */
  #propertySummary {
    grid-template-columns: repeat(2, 1fr) !important;
  }
  
  /* Timeline compact */
  .timeline {
    flex-wrap: wrap;
    gap: 8px;
    justify-content: flex-start;
  }
  .timeline::before {
    display: none;
  }
  .timeline-item {
    flex: 0 0 calc(20% - 8px);
    max-width: calc(20% - 8px);
    margin-bottom: 12px;
  }
  .timeline-icon {
    width: 32px;
    height: 32px;
    font-size: 0.8rem;
  }
  
  /* Charts smaller */
  .donut-chart svg {
    width: 140px;
    height: 140px;
  }
}

/* Touch-friendly improvements for all tablets */
@media (pointer: coarse) {
  .filter-btn,
  .period-btn,
  .tab,
  .card-action-btn {
    min-height: 44px;
    min-width: 44px;
    cursor: pointer;
    -webkit-tap-highlight-color: rgba(0,0,0,0.1);
  }
  
  .property-row {
    min-height: 52px;
    cursor: pointer;
    -webkit-tap-highlight-color: rgba(0,0,0,0.1);
  }
  
  /* Larger touch targets */
  .expand-cell {
    width: 44px;
    padding: 12px 8px !important;
  }
  .expand-icon {
    font-size: 0.9rem;
  }
  
  /* Prevent text selection on touch */
  .filter-btn,
  .property-row,
  .tab,
  .period-btn {
    -webkit-user-select: none;
    user-select: none;
    touch-action: manipulation;
  }
  
  /* Active states for touch feedback */
  .filter-btn:active,
  .period-btn:active,
  .tab:active {
    transform: scale(0.98);
    opacity: 0.9;
  }
  .property-row:active {
    background: var(--bg-card-hover) !important;
  }
}

/* Landscape orientation for iPad */
@media (max-width: 1024px) and (orientation: landscape) {
  .kpi-grid { 
    grid-template-columns: repeat(5, 1fr); 
  }
  .grid-2 { 
    grid-template-columns: repeat(2, 1fr); 
  }
  .grid-3 { 
    grid-template-columns: repeat(3, 1fr); 
  }
  #propertySummary {
    grid-template-columns: repeat(5, 1fr) !important;
  }
}

/* Print styles for documentation */
@media print {
  .tabs, .period-filter, .card-action-btn, .filter-btn {
    display: none !important;
  }
  .card {
    break-inside: avoid;
    page-break-inside: avoid;
  }
}
</style>
</head>
<body>

<div class="container">
  <header>
    <h1>ğŸ“Š ãƒãƒ³ã‚·ãƒ§ãƒ³è²·å– BI Dashboard</h1>
    <div class="user-info">
      <span>ğŸ‘¤ å±±ç”° å¤ªéƒï¼ˆéƒ¨é•·ï¼‰</span>
      <span>ğŸ“… 2024/12/19</span>
    </div>
  </header>

  <div class="tabs">
    <button class="tab" onclick="showTab('approval')">æ‰¿èªå¾…ã¡<span class="badge">3</span></button>
    <button class="tab" onclick="showTab('approved')">æ‰¿èªæ¸ˆã¿</button>
    <button class="tab" onclick="showTab('rejected')">å´ä¸‹</button>
    <button class="tab active" onclick="showTab('bi')">ğŸ“Š BIãƒ»ä¿æœ‰ç‰©ä»¶</button>
  </div>

  <!-- Period Filter -->
  <div class="period-filter">
    <label>ğŸ“… è¡¨ç¤ºæœŸé–“:</label>
    <button class="period-btn" onclick="setPeriod(this, 'month')">ä»Šæœˆ</button>
    <button class="period-btn active" onclick="setPeriod(this, 'quarter')">å››åŠæœŸ</button>
    <button class="period-btn" onclick="setPeriod(this, 'half')">åŠæœŸ</button>
    <button class="period-btn" onclick="setPeriod(this, 'year')">å¹´é–“</button>
    <div class="date-range">
      <input type="date" value="2024-10-01">
      <span>ã€œ</span>
      <input type="date" value="2024-12-19">
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="kpi-grid">
    <div class="kpi-card blue animate-in">
      <div class="kpi-label">ä¿æœ‰ç‰©ä»¶æ•°</div>
      <div class="kpi-value">30ä»¶</div>
      <div class="kpi-change up">
        <span>â–²</span> å‰æœˆæ¯” +5ä»¶
      </div>
      <div class="sparkline" style="margin-top:12px;">
        <div class="sparkline-bar" style="height:40%"></div>
        <div class="sparkline-bar" style="height:55%"></div>
        <div class="sparkline-bar" style="height:65%"></div>
        <div class="sparkline-bar" style="height:70%"></div>
        <div class="sparkline-bar" style="height:80%"></div>
        <div class="sparkline-bar" style="height:100%"></div>
      </div>
    </div>
    
    <div class="kpi-card green animate-in delay-1">
      <div class="kpi-label">ç·åœ¨åº«é¡</div>
      <div class="kpi-value">113.7å„„</div>
      <div class="kpi-change up">
        <span>â–²</span> å‰æœˆæ¯” +18.2å„„
      </div>
      <div class="kpi-target">æ¸¯åŒº: 20ä»¶ / 67%</div>
      <div class="kpi-progress">
        <div class="kpi-progress-bar" style="width:67%;background:var(--success);"></div>
      </div>
    </div>
    
    <div class="kpi-card orange animate-in delay-2">
      <div class="kpi-label">å¹³å‡ä¾¡æ ¼</div>
      <div class="kpi-value">3.79å„„</div>
      <div class="kpi-change up">
        <span>â–²</span> å‰æœˆæ¯” +0.3å„„
      </div>
      <div class="kpi-target">ä¾¡æ ¼å¸¯: 1.6å„„ã€œ9å„„</div>
      <div class="kpi-progress">
        <div class="kpi-progress-bar" style="width:85%;background:var(--warning);"></div>
      </div>
    </div>
    
    <div class="kpi-card purple animate-in delay-3">
      <div class="kpi-label">å¹³å‡åªå˜ä¾¡</div>
      <div class="kpi-value">1,384ä¸‡</div>
      <div class="kpi-change up">
        <span>â–²</span> å‰æœˆæ¯” +52ä¸‡
      </div>
      <div class="kpi-target">æœ€é«˜: 2,994ä¸‡å††ï¼ˆè¡¨å‚é“ï¼‰</div>
      <div class="kpi-progress">
        <div class="kpi-progress-bar" style="width:78%;background:#8b5cf6;"></div>
      </div>
    </div>
    
    <div class="kpi-card red animate-in delay-4">
      <div class="kpi-label">å¹³å‡å°‚æœ‰é¢ç©</div>
      <div class="kpi-value">85.2ã¡</div>
      <div class="kpi-change down">
        <span>â–¼</span> å‰æœˆæ¯” -2.1ã¡
      </div>
      <div class="kpi-target">é–“å–ã‚Š: 2LDKä¸­å¿ƒ</div>
      <div class="kpi-progress">
        <div class="kpi-progress-bar" style="width:70%;background:var(--danger);"></div>
      </div>
    </div>
  </div>

  <!-- Row 1: Charts -->
  <div class="grid-2">
    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ“ˆ æœˆåˆ¥ä»•å…¥ãƒ»è²©å£²å®Ÿç¸¾</div>
        <div class="card-actions">
          <button class="card-action-btn">é‡‘é¡</button>
          <button class="card-action-btn">ä»¶æ•°</button>
        </div>
      </div>
      <div class="bar-chart">
        <div class="bar-group">
          <div class="bar-wrapper">
            <div class="bar purchase" style="height:60%;" data-value="4.2å„„"></div>
            <div class="bar sales" style="height:45%;" data-value="3.1å„„"></div>
          </div>
          <div class="bar-label">7æœˆ</div>
        </div>
        <div class="bar-group">
          <div class="bar-wrapper">
            <div class="bar purchase" style="height:80%;" data-value="5.6å„„"></div>
            <div class="bar sales" style="height:55%;" data-value="3.9å„„"></div>
          </div>
          <div class="bar-label">8æœˆ</div>
        </div>
        <div class="bar-group">
          <div class="bar-wrapper">
            <div class="bar purchase" style="height:70%;" data-value="4.9å„„"></div>
            <div class="bar sales" style="height:85%;" data-value="6.0å„„"></div>
          </div>
          <div class="bar-label">9æœˆ</div>
        </div>
        <div class="bar-group">
          <div class="bar-wrapper">
            <div class="bar purchase" style="height:90%;" data-value="6.3å„„"></div>
            <div class="bar sales" style="height:65%;" data-value="4.6å„„"></div>
          </div>
          <div class="bar-label">10æœˆ</div>
        </div>
        <div class="bar-group">
          <div class="bar-wrapper">
            <div class="bar purchase" style="height:75%;" data-value="5.3å„„"></div>
            <div class="bar sales" style="height:90%;" data-value="6.3å„„"></div>
          </div>
          <div class="bar-label">11æœˆ</div>
        </div>
        <div class="bar-group">
          <div class="bar-wrapper">
            <div class="bar purchase" style="height:50%;" data-value="3.5å„„"></div>
            <div class="bar sales" style="height:40%;" data-value="2.8å„„"></div>
          </div>
          <div class="bar-label">12æœˆ</div>
        </div>
      </div>
      <div class="chart-legend">
        <div class="legend-item"><div class="legend-dot" style="background:var(--accent);"></div>ä»•å…¥</div>
        <div class="legend-item"><div class="legend-dot" style="background:var(--success);"></div>è²©å£²</div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ“Š ç²—åˆ©ç‡æ¨ç§»</div>
      </div>
      <div class="line-chart-container">
        <svg class="line-chart" viewBox="0 0 400 150" preserveAspectRatio="none">
          <!-- Grid -->
          <line x1="0" y1="30" x2="400" y2="30" class="line-chart-grid" stroke-dasharray="4"/>
          <line x1="0" y1="60" x2="400" y2="60" class="line-chart-grid" stroke-dasharray="4"/>
          <line x1="0" y1="90" x2="400" y2="90" class="line-chart-grid" stroke-dasharray="4"/>
          <line x1="0" y1="120" x2="400" y2="120" class="line-chart-grid" stroke-dasharray="4"/>
          <!-- Area -->
          <path d="M0,90 L66,75 L133,85 L200,70 L266,55 L333,45 L400,40 L400,150 L0,150 Z" class="line-chart-area" fill="var(--success)"/>
          <!-- Line -->
          <path d="M0,90 L66,75 L133,85 L200,70 L266,55 L333,45 L400,40" class="line-chart-line" stroke="var(--success)"/>
          <!-- Dots -->
          <circle cx="0" cy="90" r="5" fill="var(--success)" class="line-chart-dot"/>
          <circle cx="66" cy="75" r="5" fill="var(--success)" class="line-chart-dot"/>
          <circle cx="133" cy="85" r="5" fill="var(--success)" class="line-chart-dot"/>
          <circle cx="200" cy="70" r="5" fill="var(--success)" class="line-chart-dot"/>
          <circle cx="266" cy="55" r="5" fill="var(--success)" class="line-chart-dot"/>
          <circle cx="333" cy="45" r="5" fill="var(--success)" class="line-chart-dot"/>
          <circle cx="400" cy="40" r="6" fill="var(--success)" class="line-chart-dot" stroke="#fff" stroke-width="2"/>
        </svg>
        <div style="position:absolute;right:10px;top:35px;font-size:0.75rem;color:var(--text-muted);">30%</div>
        <div style="position:absolute;right:10px;top:55px;font-size:0.75rem;color:var(--text-muted);">25%</div>
        <div style="position:absolute;right:10px;top:85px;font-size:0.75rem;color:var(--text-muted);">20%</div>
        <div style="position:absolute;right:10px;top:115px;font-size:0.75rem;color:var(--text-muted);">15%</div>
      </div>
      <div class="line-chart-labels">
        <span>7æœˆ</span><span>8æœˆ</span><span>9æœˆ</span><span>10æœˆ</span><span>11æœˆ</span><span>12æœˆ</span>
      </div>
    </div>
  </div>

  <!-- Row 2: Distribution Charts -->
  <div class="grid-3">
    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ¢ ã‚¨ãƒªã‚¢åˆ¥ä¿æœ‰ç‰©ä»¶</div>
      </div>
      <div class="donut-chart-container">
        <div class="donut-chart">
          <svg width="160" height="160" viewBox="0 0 160 160">
            <circle cx="80" cy="80" r="60" fill="none" stroke="#3a3a55" stroke-width="20"/>
            <!-- æ¸¯åŒº: 20ä»¶ = 67% = 251 * 0.67 = 168 -->
            <circle cx="80" cy="80" r="60" fill="none" stroke="#00ff88" stroke-width="20" 
                    stroke-dasharray="168 252" stroke-dashoffset="0"/>
            <!-- ä¸­å¤®åŒº: 4ä»¶ = 13% = 33 -->
            <circle cx="80" cy="80" r="60" fill="none" stroke="#ff3e9d" stroke-width="20" 
                    stroke-dasharray="33 252" stroke-dashoffset="-168"/>
            <!-- æ¸‹è°·åŒº: 3ä»¶ = 10% = 25 -->
            <circle cx="80" cy="80" r="60" fill="none" stroke="#00d4ff" stroke-width="20" 
                    stroke-dasharray="25 252" stroke-dashoffset="-201"/>
            <!-- åƒä»£ç”°åŒº: 2ä»¶ = 7% = 17 -->
            <circle cx="80" cy="80" r="60" fill="none" stroke="#a855f7" stroke-width="20" 
                    stroke-dasharray="17 252" stroke-dashoffset="-226"/>
            <!-- æ–‡äº¬åŒº: 1ä»¶ = 3% = 8 -->
            <circle cx="80" cy="80" r="60" fill="none" stroke="#ffaa00" stroke-width="20" 
                    stroke-dasharray="8 252" stroke-dashoffset="-243"/>
          </svg>
          <div class="donut-center">
            <div class="donut-center-value">30</div>
            <div class="donut-center-label">ç‰©ä»¶</div>
          </div>
        </div>
        <div class="donut-legend">
          <div class="donut-legend-item">
            <div class="donut-legend-left">
              <div class="donut-legend-dot" style="background:var(--neon-green);box-shadow:0 0 8px var(--neon-green-glow);"></div>
              <span class="donut-legend-label">æ¸¯åŒº</span>
            </div>
            <span class="donut-legend-value">20ä»¶ï¼ˆ67%ï¼‰</span>
          </div>
          <div class="donut-legend-item">
            <div class="donut-legend-left">
              <div class="donut-legend-dot" style="background:var(--neon-pink);box-shadow:0 0 8px var(--neon-pink-glow);"></div>
              <span class="donut-legend-label">ä¸­å¤®åŒº</span>
            </div>
            <span class="donut-legend-value">4ä»¶ï¼ˆ13%ï¼‰</span>
          </div>
          <div class="donut-legend-item">
            <div class="donut-legend-left">
              <div class="donut-legend-dot" style="background:var(--info);box-shadow:0 0 8px rgba(0,212,255,0.4);"></div>
              <span class="donut-legend-label">æ¸‹è°·åŒº</span>
            </div>
            <span class="donut-legend-value">3ä»¶ï¼ˆ10%ï¼‰</span>
          </div>
          <div class="donut-legend-item">
            <div class="donut-legend-left">
              <div class="donut-legend-dot" style="background:#a855f7;box-shadow:0 0 8px rgba(168,85,247,0.4);"></div>
              <span class="donut-legend-label">åƒä»£ç”°åŒº</span>
            </div>
            <span class="donut-legend-value">2ä»¶ï¼ˆ7%ï¼‰</span>
          </div>
          <div class="donut-legend-item">
            <div class="donut-legend-left">
              <div class="donut-legend-dot" style="background:var(--warning);box-shadow:0 0 8px rgba(255,170,0,0.4);"></div>
              <span class="donut-legend-label">æ–‡äº¬åŒº</span>
            </div>
            <span class="donut-legend-value">1ä»¶ï¼ˆ3%ï¼‰</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ’° ä¾¡æ ¼å¸¯åˆ¥åˆ†å¸ƒ</div>
      </div>
      <div class="h-bar-chart">
        <div class="h-bar-item">
          <div class="h-bar-header">
            <span class="h-bar-label">ã€œ2å„„å††</span>
            <span class="h-bar-value">4ä»¶</span>
          </div>
          <div class="h-bar-track">
            <div class="h-bar-fill" style="width:29%;background:linear-gradient(90deg,#10b981,#059669);">13%</div>
          </div>
        </div>
        <div class="h-bar-item">
          <div class="h-bar-header">
            <span class="h-bar-label">2ã€œ3å„„å††</span>
            <span class="h-bar-value">6ä»¶</span>
          </div>
          <div class="h-bar-track">
            <div class="h-bar-fill" style="width:43%;background:linear-gradient(90deg,#3b82f6,#2563eb);">20%</div>
          </div>
        </div>
        <div class="h-bar-item">
          <div class="h-bar-header">
            <span class="h-bar-label">3ã€œ5å„„å††</span>
            <span class="h-bar-value">14ä»¶</span>
          </div>
          <div class="h-bar-track">
            <div class="h-bar-fill" style="width:100%;background:linear-gradient(90deg,#f59e0b,#d97706);">47%</div>
          </div>
        </div>
        <div class="h-bar-item">
          <div class="h-bar-header">
            <span class="h-bar-label">5å„„å††ã€œ</span>
            <span class="h-bar-value">6ä»¶</span>
          </div>
          <div class="h-bar-track">
            <div class="h-bar-fill" style="width:43%;background:linear-gradient(90deg,#ef4444,#dc2626);">20%</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ¯ äºˆç®—é”æˆçŠ¶æ³</div>
      </div>
      <div class="gauge-container">
        <div class="gauge">
          <svg width="180" height="100" viewBox="0 0 180 100">
            <path d="M 10 90 A 80 80 0 0 1 170 90" class="gauge-bg"/>
            <path d="M 10 90 A 80 80 0 0 1 170 90" class="gauge-fill" stroke="var(--success)" 
                  stroke-dasharray="251" stroke-dashoffset="30"/>
          </svg>
          <div class="gauge-center">
            <div class="gauge-value" style="color:var(--success);">87.8%</div>
            <div class="gauge-label">äºˆç®—é”æˆç‡</div>
          </div>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px;">
        <div style="text-align:center;padding:12px;background:var(--bg);border-radius:8px;">
          <div style="font-size:0.75rem;color:var(--text-muted);">å®Ÿç¸¾ç²—åˆ©</div>
          <div style="font-size:1.1rem;font-weight:700;color:var(--success);">15.8å„„å††</div>
        </div>
        <div style="text-align:center;padding:12px;background:var(--bg);border-radius:8px;">
          <div style="font-size:0.75rem;color:var(--text-muted);">ç›®æ¨™ç²—åˆ©</div>
          <div style="font-size:1.1rem;font-weight:700;color:var(--text);">18.0å„„å††</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Row 3: Heatmap & Alerts -->
  <div class="grid-2">
    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ—ºï¸ ã‚¨ãƒªã‚¢Ã—ä¾¡æ ¼å¸¯ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</div>
        <div class="card-actions">
          <button class="card-action-btn">ä»¶æ•°</button>
          <button class="card-action-btn">ç²—åˆ©ç‡</button>
        </div>
      </div>
      <div class="heatmap">
        <div class="heatmap-header">
          <span>ã€œ1å„„</span>
          <span>1ã€œ2å„„</span>
          <span>2ã€œ3å„„</span>
          <span>3å„„ã€œ</span>
        </div>
        <div class="heatmap-row">
          <div class="heatmap-label">æ¸¯åŒº</div>
          <div class="heatmap-cell" style="background:#93c5fd;" data-count="1" data-profit="18.5%">1</div>
          <div class="heatmap-cell" style="background:#3b82f6;" data-count="3" data-profit="22.1%">3</div>
          <div class="heatmap-cell" style="background:#1d4ed8;" data-count="3" data-profit="25.8%">3</div>
          <div class="heatmap-cell" style="background:#1e3a8a;" data-count="1" data-profit="28.2%">1</div>
        </div>
        <div class="heatmap-row">
          <div class="heatmap-label">ä¸­å¤®åŒº</div>
          <div class="heatmap-cell" style="background:#86efac;" data-count="2" data-profit="19.2%">2</div>
          <div class="heatmap-cell" style="background:#22c55e;" data-count="2" data-profit="21.5%">2</div>
          <div class="heatmap-cell" style="background:#16a34a;" data-count="2" data-profit="24.3%">2</div>
          <div class="heatmap-cell" style="background:#e2e8f0;" data-count="0" data-profit="-">-</div>
        </div>
        <div class="heatmap-row">
          <div class="heatmap-label">æ¸‹è°·åŒº</div>
          <div class="heatmap-cell" style="background:#e2e8f0;" data-count="0" data-profit="-">-</div>
          <div class="heatmap-cell" style="background:#fcd34d;" data-count="2" data-profit="20.8%">2</div>
          <div class="heatmap-cell" style="background:#f59e0b;" data-count="2" data-profit="23.1%">2</div>
          <div class="heatmap-cell" style="background:#d97706;" data-count="1" data-profit="26.5%">1</div>
        </div>
        <div class="heatmap-row">
          <div class="heatmap-label">æ–°å®¿åŒº</div>
          <div class="heatmap-cell" style="background:#c4b5fd;" data-count="1" data-profit="17.8%">1</div>
          <div class="heatmap-cell" style="background:#a78bfa;" data-count="2" data-profit="21.2%">2</div>
          <div class="heatmap-cell" style="background:#8b5cf6;" data-count="2" data-profit="24.6%">2</div>
          <div class="heatmap-cell" style="background:#e2e8f0;" data-count="0" data-profit="-">-</div>
        </div>
        <div class="heatmap-row">
          <div class="heatmap-label">ãã®ä»–</div>
          <div class="heatmap-cell" style="background:#cbd5e1;" data-count="1" data-profit="16.2%">1</div>
          <div class="heatmap-cell" style="background:#94a3b8;" data-count="2" data-profit="19.8%">2</div>
          <div class="heatmap-cell" style="background:#64748b;" data-count="1" data-profit="22.4%">1</div>
          <div class="heatmap-cell" style="background:#e2e8f0;" data-count="0" data-profit="-">-</div>
        </div>
      </div>
      <div style="display:flex;justify-content:center;gap:16px;margin-top:16px;font-size:0.75rem;color:var(--text-muted);">
        <span>è–„ = å°‘æ•°/ä½ç²—åˆ©</span>
        <span>â†’</span>
        <span>æ¿ƒ = å¤šæ•°/é«˜ç²—åˆ©</span>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">âš ï¸ ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
        <span style="font-size:0.8rem;color:var(--text-muted);">è¦å¯¾å¿œ: 5ä»¶</span>
      </div>
      <div class="alert-list">
        <div class="alert-item critical">
          <div class="alert-icon">ğŸš¨</div>
          <div class="alert-content">
            <div class="alert-title">é•·æœŸæ»ç•™ï¼ˆ285æ—¥ï¼‰</div>
            <div class="alert-desc">ã‚°ãƒ©ãƒ³ãƒ‰ãƒ¡ã‚¾ãƒ³æµæ¯”å¯¿ 908 - ç²—åˆ©ç‡ä½ä¸‹ãƒªã‚¹ã‚¯</div>
          </div>
          <button class="alert-action">å¯¾ç­–æ¤œè¨</button>
        </div>
        <div class="alert-item critical">
          <div class="alert-icon">ğŸ“‰</div>
          <div class="alert-content">
            <div class="alert-title">ä¾¡æ ¼ä¸‹è½ãƒªã‚¹ã‚¯</div>
            <div class="alert-desc">ã‚¶ãƒ»ã‚¿ãƒ¯ãƒ¼æ¨ªæµœåŒ—ä»² 4201 - ç›¸å ´ä¸‹è½å‚¾å‘</div>
          </div>
          <button class="alert-action">ä¾¡æ ¼è¦‹ç›´ã—</button>
        </div>
        <div class="alert-item warning">
          <div class="alert-icon">â°</div>
          <div class="alert-content">
            <div class="alert-title">ä¿æœ‰æœŸé–“6ãƒ¶æœˆè¶…é</div>
            <div class="alert-desc">ã‚·ãƒ†ã‚£ã‚¿ãƒ¯ãƒ¼å“å· 1402 - 103æ—¥çµŒé</div>
          </div>
          <button class="alert-action">çŠ¶æ³ç¢ºèª</button>
        </div>
        <div class="alert-item warning">
          <div class="alert-icon">ğŸ’°</div>
          <div class="alert-content">
            <div class="alert-title">ç²—åˆ©ç‡ç›®æ¨™æœªé”</div>
            <div class="alert-desc">ãƒ–ãƒªãƒªã‚¢ã‚¿ãƒ¯ãƒ¼æ± è¢‹ 3201 - ç¾åœ¨16.7%</div>
          </div>
          <button class="alert-action">å†æŸ»å®š</button>
        </div>
        <div class="alert-item info">
          <div class="alert-icon">ğŸ“‹</div>
          <div class="alert-content">
            <div class="alert-title">æ‰¿èªæœŸé™æ¥è¿‘</div>
            <div class="alert-desc">èŠæµ¦ã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã‚°ãƒ­ãƒ¼ãƒ´ã‚¿ãƒ¯ãƒ¼ 505 - æœ¬æ—¥ä¸­</div>
          </div>
          <button class="alert-action">æ‰¿èªã¸</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Row 4: Performance Analysis -->
  <div class="grid-2">
    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸ“Š ä¿æœ‰æœŸé–“åˆ¥ ç²—åˆ©ç‡åˆ†æ</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;">
        <div style="background:linear-gradient(135deg,#d1fae5,#a7f3d0);padding:20px;border-radius:12px;text-align:center;">
          <div style="font-size:2rem;font-weight:700;color:#065f46;">26.8%</div>
          <div style="font-size:0.8rem;color:#065f46;margin-top:4px;">ã€œ3ãƒ¶æœˆ</div>
          <div style="font-size:0.75rem;color:#047857;margin-top:8px;">12ä»¶ / å¹³å‡45æ—¥</div>
        </div>
        <div style="background:linear-gradient(135deg,#fef3c7,#fde68a);padding:20px;border-radius:12px;text-align:center;">
          <div style="font-size:2rem;font-weight:700;color:#92400e;">22.1%</div>
          <div style="font-size:0.8rem;color:#92400e;margin-top:4px;">3ã€œ6ãƒ¶æœˆ</div>
          <div style="font-size:0.75rem;color:#b45309;margin-top:8px;">9ä»¶ / å¹³å‡124æ—¥</div>
        </div>
        <div style="background:linear-gradient(135deg,#fee2e2,#fecaca);padding:20px;border-radius:12px;text-align:center;">
          <div style="font-size:2rem;font-weight:700;color:#991b1b;">18.5%</div>
          <div style="font-size:0.8rem;color:#991b1b;margin-top:4px;">6ã€œ9ãƒ¶æœˆ</div>
          <div style="font-size:0.75rem;color:#b91c1c;margin-top:8px;">5ä»¶ / å¹³å‡215æ—¥</div>
        </div>
        <div style="background:linear-gradient(135deg,#7f1d1d,#991b1b);padding:20px;border-radius:12px;text-align:center;">
          <div style="font-size:2rem;font-weight:700;color:#fff;">12.3%</div>
          <div style="font-size:0.8rem;color:#fecaca;margin-top:4px;">9ãƒ¶æœˆã€œ</div>
          <div style="font-size:0.75rem;color:#fca5a5;margin-top:8px;">2ä»¶ / å¹³å‡298æ—¥</div>
        </div>
      </div>
      <div style="margin-top:20px;padding:16px;background:var(--bg);border-radius:8px;">
        <div style="font-size:0.85rem;color:var(--text-muted);margin-bottom:8px;">ğŸ’¡ ã‚¤ãƒ³ã‚µã‚¤ãƒˆ</div>
        <div style="font-size:0.9rem;color:var(--text);">ä¿æœ‰æœŸé–“ãŒ3ãƒ¶æœˆã‚’è¶…ãˆã‚‹ã¨ç²—åˆ©ç‡ãŒ<strong style="color:var(--danger);">å¹³å‡4.7%ä½ä¸‹</strong>ã€‚æ—©æœŸå£²å´æˆ¦ç•¥ã®å¼·åŒ–ã‚’æ¨å¥¨ã€‚</div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">ğŸƒ ã‚¨ãƒªã‚¢åˆ¥ å¹³å‡æˆç´„ã‚¹ãƒ”ãƒ¼ãƒ‰</div>
      </div>
      <div style="padding:10px 0;">
        <div style="display:flex;align-items:center;gap:16px;padding:12px 0;border-bottom:1px solid var(--border);">
          <div style="width:80px;font-size:0.9rem;font-weight:600;">ä¸­å¤®åŒº</div>
          <div style="flex:1;height:12px;background:var(--bg);border-radius:6px;overflow:hidden;">
            <div style="height:100%;width:60%;background:var(--success);border-radius:6px;"></div>
          </div>
          <div style="width:80px;text-align:right;">
            <span style="font-weight:700;color:var(--success);">72æ—¥</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:16px;padding:12px 0;border-bottom:1px solid var(--border);">
          <div style="width:80px;font-size:0.9rem;font-weight:600;">æ¸¯åŒº</div>
          <div style="flex:1;height:12px;background:var(--bg);border-radius:6px;overflow:hidden;">
            <div style="height:100%;width:70%;background:var(--success);border-radius:6px;"></div>
          </div>
          <div style="width:80px;text-align:right;">
            <span style="font-weight:700;color:var(--success);">84æ—¥</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:16px;padding:12px 0;border-bottom:1px solid var(--border);">
          <div style="width:80px;font-size:0.9rem;font-weight:600;">æ–°å®¿åŒº</div>
          <div style="flex:1;height:12px;background:var(--bg);border-radius:6px;overflow:hidden;">
            <div style="height:100%;width:78%;background:var(--warning);border-radius:6px;"></div>
          </div>
          <div style="width:80px;text-align:right;">
            <span style="font-weight:700;color:var(--warning);">93æ—¥</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:16px;padding:12px 0;border-bottom:1px solid var(--border);">
          <div style="width:80px;font-size:0.9rem;font-weight:600;">æ¸‹è°·åŒº</div>
          <div style="flex:1;height:12px;background:var(--bg);border-radius:6px;overflow:hidden;">
            <div style="height:100%;width:88%;background:var(--warning);border-radius:6px;"></div>
          </div>
          <div style="width:80px;text-align:right;">
            <span style="font-weight:700;color:var(--warning);">105æ—¥</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:16px;padding:12px 0;">
          <div style="width:80px;font-size:0.9rem;font-weight:600;">ãã®ä»–</div>
          <div style="flex:1;height:12px;background:var(--bg);border-radius:6px;overflow:hidden;">
            <div style="height:100%;width:100%;background:var(--danger);border-radius:6px;"></div>
          </div>
          <div style="width:80px;text-align:right;">
            <span style="font-weight:700;color:var(--danger);">128æ—¥</span>
          </div>
        </div>
      </div>
      <div style="margin-top:12px;padding:12px;background:#eff6ff;border-radius:8px;display:flex;align-items:center;gap:8px;">
        <span style="font-size:1.2rem;">ğŸ¯</span>
        <span style="font-size:0.85rem;color:var(--primary);">ç›®æ¨™: 90æ—¥ä»¥å†…</span>
      </div>
    </div>
  </div>

  <!-- Row 5: Property List -->
  <div class="card">
    <div class="card-header">
      <div class="card-title">ğŸ  è‡ªç¤¾ä¿æœ‰ç‰©ä»¶ä¸€è¦§ï¼ˆREINSãƒ‡ãƒ¼ã‚¿ 12/19æ™‚ç‚¹ï¼‰</div>
      <div class="card-actions">
        <button class="card-action-btn" style="background:var(--accent);color:#fff;border:none;" onclick="exportCSV()">
          ğŸ“¥ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        </button>
      </div>
    </div>
    
    <!-- Filter Buttons -->
    <div style="margin-bottom:20px;padding:20px;background:var(--bg-dark);border:1px solid var(--border);border-radius:12px;">
      <div style="margin-bottom:16px;">
        <div style="font-size:0.85rem;font-weight:600;color:var(--text-muted);margin-bottom:10px;">ğŸ“ ã‚¨ãƒªã‚¢ <span style="font-size:0.75rem;font-weight:normal;">ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</span></div>
        <div style="display:flex;flex-wrap:wrap;gap:8px;" id="filterAreaBtns">
          <button class="filter-btn active" data-filter="area" data-value="" onclick="toggleFilterBtn(this)">ã™ã¹ã¦</button>
          <button class="filter-btn" data-filter="area" data-value="æ¸¯åŒº" onclick="toggleFilterBtn(this)">æ¸¯åŒº <span class="filter-count">(20)</span></button>
          <button class="filter-btn" data-filter="area" data-value="ä¸­å¤®åŒº" onclick="toggleFilterBtn(this)">ä¸­å¤®åŒº <span class="filter-count">(4)</span></button>
          <button class="filter-btn" data-filter="area" data-value="æ¸‹è°·åŒº" onclick="toggleFilterBtn(this)">æ¸‹è°·åŒº <span class="filter-count">(3)</span></button>
          <button class="filter-btn" data-filter="area" data-value="åƒä»£ç”°åŒº" onclick="toggleFilterBtn(this)">åƒä»£ç”°åŒº <span class="filter-count">(2)</span></button>
          <button class="filter-btn" data-filter="area" data-value="æ–‡äº¬åŒº" onclick="toggleFilterBtn(this)">æ–‡äº¬åŒº <span class="filter-count">(1)</span></button>
        </div>
      </div>
      
      <div style="margin-bottom:16px;">
        <div style="font-size:0.85rem;font-weight:600;color:var(--text-muted);margin-bottom:10px;">ğŸ’° ä¾¡æ ¼å¸¯ <span style="font-size:0.75rem;font-weight:normal;">ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</span></div>
        <div style="display:flex;flex-wrap:wrap;gap:8px;" id="filterPriceBtns">
          <button class="filter-btn active" data-filter="price" data-value="" onclick="toggleFilterBtn(this)">ã™ã¹ã¦</button>
          <button class="filter-btn" data-filter="price" data-value="20000" onclick="toggleFilterBtn(this)">ã€œ2å„„å†† <span class="filter-count">(4)</span></button>
          <button class="filter-btn" data-filter="price" data-value="30000" onclick="toggleFilterBtn(this)">2ã€œ3å„„å†† <span class="filter-count">(6)</span></button>
          <button class="filter-btn" data-filter="price" data-value="50000" onclick="toggleFilterBtn(this)">3ã€œ5å„„å†† <span class="filter-count">(14)</span></button>
          <button class="filter-btn" data-filter="price" data-value="99999" onclick="toggleFilterBtn(this)">5å„„å††ã€œ <span class="filter-count">(6)</span></button>
        </div>
      </div>
      
      <div>
        <div style="font-size:0.85rem;font-weight:600;color:var(--text-muted);margin-bottom:10px;">ğŸ  é–“å–ã‚Š <span style="font-size:0.75rem;font-weight:normal;">ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</span></div>
        <div style="display:flex;flex-wrap:wrap;gap:8px;" id="filterLayoutBtns">
          <button class="filter-btn active" data-filter="layout" data-value="" onclick="toggleFilterBtn(this)">ã™ã¹ã¦</button>
          <button class="filter-btn" data-filter="layout" data-value="1LDK" onclick="toggleFilterBtn(this)">1LDK <span class="filter-count">(1)</span></button>
          <button class="filter-btn" data-filter="layout" data-value="2LDK" onclick="toggleFilterBtn(this)">2LDK <span class="filter-count">(18)</span></button>
          <button class="filter-btn" data-filter="layout" data-value="3LDK" onclick="toggleFilterBtn(this)">3LDK <span class="filter-count">(11)</span></button>
        </div>
      </div>
    </div>
    <div id="propertySummary" style="display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:20px;padding:16px;background:var(--bg-dark);border:1px solid var(--border);border-radius:8px;">
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);">ç‰©ä»¶æ•°</div><div style="font-size:1.2rem;font-weight:700;color:var(--text);" id="totalCount">30ä»¶</div></div>
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);">ç·é¡</div><div style="font-size:1.2rem;font-weight:700;color:var(--danger);" id="totalValue">113.7å„„å††</div></div>
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);">å¹³å‡ä¾¡æ ¼</div><div style="font-size:1.2rem;font-weight:700;color:var(--text);" id="avgPrice">3.79å„„å††</div></div>
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);">å¹³å‡åªå˜ä¾¡</div><div style="font-size:1.2rem;font-weight:700;color:var(--text);" id="avgTsubo">1,384ä¸‡å††</div></div>
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);">å¹³å‡å°‚æœ‰é¢ç©</div><div style="font-size:1.2rem;font-weight:700;color:var(--text);" id="avgArea">85.2ã¡</div></div>
    </div>
    <div style="overflow-x:auto;-webkit-overflow-scrolling:touch;margin:0 -4px;padding:0 4px;">
    <table id="propertyTable">
      <thead>
        <tr>
          <th style="width:40px;"></th>
          <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
          <th style="cursor:pointer;" onclick="sortTable(2)">æ‰€åœ¨åœ° â†•</th>
          <th style="cursor:pointer;" onclick="sortTable(3)">ç‰©ä»¶å â†•</th>
          <th>æ‰€åœ¨éš</th>
          <th>é–“å–ã‚Š</th>
          <th>å°‚æœ‰é¢ç©</th>
          <th style="cursor:pointer;" onclick="sortTable(7)">ä¾¡æ ¼ â†•</th>
          <th style="cursor:pointer;" onclick="sortTable(8)">åªå˜ä¾¡ â†•</th>
          <th>ç¯‰å¹´æœˆ</th>
          <th>æœ€å¯„é§…</th>
        </tr>
      </thead>
      <tbody id="propertyBody">
        <tr data-area="æ¸¯åŒº" data-price="89800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-08-15","buyAcceptDate":"2024-08-22","contractDate":"2024-09-10","deliveryDate":"2024-10-15","startDate":"2024-10-20","completeDate":"2024-12-05","saleStartDate":"2024-12-10","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºå—é’å±±1ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚³ãƒ¼ãƒˆä¹ƒæœ¨å‚ã‚¶ã‚¿ãƒ¯ãƒ¼</td>
          <td>25éš</td>
          <td>3LDK</td>
          <td>100.65ã¡</td>
          <td class="price-cell">89,800ä¸‡å††</td>
          <td>2,949.5ä¸‡å††</td>
          <td>2019å¹´1æœˆ</td>
          <td>ä¹ƒæœ¨å‚ å¾’æ­©2åˆ†</td>
        </tr>
        <tr data-area="æ¸‹è°·åŒº" data-price="76800" data-layout="1LDK" class="property-row"  data-schedule='{"buyDate":"2024-07-01","buyAcceptDate":"2024-07-08","contractDate":"2024-07-25","deliveryDate":"2024-08-30","startDate":"2024-09-05","completeDate":"2024-11-15","saleStartDate":"2024-11-20","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸‹è°·åŒºç¥å®®å‰4ä¸ç›®</td>
          <td style="font-weight:600;">è¡¨å‚é“ãƒ’ãƒ«ã‚º</td>
          <td>4éš</td>
          <td>1LDK</td>
          <td>84.78ã¡</td>
          <td class="price-cell">76,800ä¸‡å††</td>
          <td>2,994.7ä¸‡å††</td>
          <td>2006å¹´1æœˆ</td>
          <td>è¡¨å‚é“ å¾’æ­©3åˆ†</td>
        </tr>
        <tr data-area="åƒä»£ç”°åŒº" data-price="74800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-06-10","buyAcceptDate":"2024-06-17","contractDate":"2024-07-05","deliveryDate":"2024-08-10","startDate":"2024-08-15","completeDate":"2024-10-20","saleStartDate":"2024-10-25","applyDate":"2024-11-30","currentStep":8}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-nego">å•†è«‡ä¸­</span></td>
          <td>åƒä»£ç”°åŒºä¸‰ç•ªç”º</td>
          <td style="font-weight:600;">ä¸‰ç•ªç”ºãƒ‘ãƒ¼ã‚¯ãƒ†ãƒ©ã‚¹æ¡œè‹‘</td>
          <td>9éš</td>
          <td>3LDK</td>
          <td>105.94ã¡</td>
          <td class="price-cell">74,800ä¸‡å††</td>
          <td>2,334.1ä¸‡å††</td>
          <td>2005å¹´8æœˆ</td>
          <td>åŠè”µé–€ å¾’æ­©4åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="62800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-09-01","buyAcceptDate":"2024-09-08","contractDate":"2024-09-25","deliveryDate":"2024-10-30","startDate":"2024-11-05","completeDate":"2024-12-15","saleStartDate":"2024-12-18","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºè™ãƒé–€3ä¸ç›®</td>
          <td style="font-weight:600;">ã‚¦ã‚§ãƒªã‚¹ã‚¿ãƒ¯ãƒ¼æ„›å®•è™ãƒé–€</td>
          <td>14éš</td>
          <td>3LDK</td>
          <td>76.31ã¡</td>
          <td class="price-cell">62,800ä¸‡å††</td>
          <td>2,720.6ä¸‡å††</td>
          <td>2014å¹´2æœˆ</td>
          <td>ç¥è°·ç”º å¾’æ­©2åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="56800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-05-15","buyAcceptDate":"2024-05-22","contractDate":"2024-06-10","deliveryDate":"2024-07-15","startDate":"2024-07-20","completeDate":"2024-09-25","saleStartDate":"2024-09-30","applyDate":"2024-11-15","saleContractDate":"2024-12-01","currentStep":9}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-nego">å•†è«‡ä¸­</span></td>
          <td>æ¸¯åŒºä¸‰ç”°1ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚³ãƒ¼ãƒˆéº»å¸ƒåç•ªã‚¶ã‚¿ãƒ¯ãƒ¼</td>
          <td>33éš</td>
          <td>3LDK</td>
          <td>88.41ã¡</td>
          <td class="price-cell">56,800ä¸‡å††</td>
          <td>2,123.9ä¸‡å††</td>
          <td>2010å¹´5æœˆ</td>
          <td>éº»å¸ƒåç•ª å¾’æ­©3åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="54800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-10-01","buyAcceptDate":"2024-10-08","contractDate":"2024-10-25","deliveryDate":"2024-11-30","startDate":"2024-12-05","currentStep":5}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-reno">ãƒªãƒãƒ™ä¸­</span></td>
          <td>æ¸¯åŒºè™ãƒé–€3ä¸ç›®</td>
          <td style="font-weight:600;">ã‚¦ã‚§ãƒªã‚¹ã‚¿ãƒ¯ãƒ¼æ„›å®•è™ãƒé–€</td>
          <td>21éš</td>
          <td>2LDK</td>
          <td>65.46ã¡</td>
          <td class="price-cell">54,800ä¸‡å††</td>
          <td>2,767.5ä¸‡å††</td>
          <td>2014å¹´2æœˆ</td>
          <td>ç¥è°·ç”º å¾’æ­©2åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="44800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-08-01","buyAcceptDate":"2024-08-08","contractDate":"2024-08-25","deliveryDate":"2024-09-30","startDate":"2024-10-05","completeDate":"2024-12-10","saleStartDate":"2024-12-15","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºé«˜è¼ª4ä¸ç›®</td>
          <td style="font-weight:600;">THE IMPREST é«˜è¼ª</td>
          <td>3éš</td>
          <td>3LDK</td>
          <td>126.43ã¡</td>
          <td class="price-cell">44,800ä¸‡å††</td>
          <td>1,171.4ä¸‡å††</td>
          <td>2017å¹´8æœˆ</td>
          <td>å“å· å¾’æ­©9åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="43800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-07-15","buyAcceptDate":"2024-07-22","contractDate":"2024-08-10","deliveryDate":"2024-09-15","startDate":"2024-09-20","completeDate":"2024-11-25","saleStartDate":"2024-11-30","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèµ¤å‚4ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚³ãƒ¼ãƒˆèµ¤å‚ã‚¶ãƒ»ã‚¿ãƒ¯ãƒ¼</td>
          <td>33éš</td>
          <td>2LDK</td>
          <td>83.84ã¡</td>
          <td class="price-cell">43,800ä¸‡å††</td>
          <td>1,727.1ä¸‡å††</td>
          <td>2009å¹´6æœˆ</td>
          <td>èµ¤å‚ å¾’æ­©9åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="42800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-09-15","buyAcceptDate":"2024-09-22","contractDate":"2024-10-10","deliveryDate":"2024-11-15","startDate":"2024-11-20","completeDate":"2024-12-18","currentStep":6}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-reno">ãƒªãƒãƒ™ä¸­</span></td>
          <td>æ¸¯åŒºè¥¿éº»å¸ƒ4ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‡ã‚£ã‚¢ãƒŠã‚¬ãƒ¼ãƒ‡ãƒ³è¥¿éº»å¸ƒ</td>
          <td>8éš</td>
          <td>2LDK</td>
          <td>100.97ã¡</td>
          <td class="price-cell">42,800ä¸‡å††</td>
          <td>1,401.3ä¸‡å††</td>
          <td>2018å¹´5æœˆ</td>
          <td>åºƒå°¾ å¾’æ­©12åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="42800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-06-01","buyAcceptDate":"2024-06-08","contractDate":"2024-06-25","deliveryDate":"2024-07-30","startDate":"2024-08-05","completeDate":"2024-10-10","saleStartDate":"2024-10-15","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦4ä¸ç›®</td>
          <td style="font-weight:600;">èŠæµ¦ã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã‚±ãƒ¼ãƒ—ã‚¿ãƒ¯ãƒ¼</td>
          <td>-</td>
          <td>3LDK</td>
          <td>133.58ã¡</td>
          <td class="price-cell">42,800ä¸‡å††</td>
          <td>1,059.2ä¸‡å††</td>
          <td>2006å¹´10æœˆ</td>
          <td>ç”°ç”º å¾’æ­©13åˆ†</td>
        </tr>
        <tr data-area="æ¸‹è°·åŒº" data-price="38800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-08-20","buyAcceptDate":"2024-08-27","contractDate":"2024-09-15","deliveryDate":"2024-10-20","startDate":"2024-10-25","completeDate":"2024-12-15","saleStartDate":"2024-12-18","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸‹è°·åŒºå¯Œãƒ¶è°·1ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ•ã‚©ãƒ¬ã‚»ãƒ¼ãƒŒæ¸‹è°·å¯Œãƒ¶è°·</td>
          <td>1éš</td>
          <td>2LDK</td>
          <td>83.90ã¡</td>
          <td class="price-cell">38,800ä¸‡å††</td>
          <td>1,528.8ä¸‡å††</td>
          <td>2022å¹´2æœˆ</td>
          <td>ä»£ã€…æœ¨å…¬åœ’ å¾’æ­©5åˆ†</td>
        </tr>
        <tr data-area="åƒä»£ç”°åŒº" data-price="36800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-07-10","buyAcceptDate":"2024-07-17","contractDate":"2024-08-05","deliveryDate":"2024-09-10","startDate":"2024-09-15","completeDate":"2024-11-20","saleStartDate":"2024-11-25","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>åƒä»£ç”°åŒºå››ç•ªç”º</td>
          <td style="font-weight:600;">ã‚¶ãƒ»ãƒ‘ãƒ¼ã‚¯ãƒã‚¦ã‚¹å››ç•ªç”ºãƒ¬ã‚¸ãƒ‡ãƒ³ã‚¹</td>
          <td>2éš</td>
          <td>3LDK</td>
          <td>78.70ã¡</td>
          <td class="price-cell">36,800ä¸‡å††</td>
          <td>1,545.8ä¸‡å††</td>
          <td>2013å¹´8æœˆ</td>
          <td>å¸‚ã‚±è°· å¾’æ­©5åˆ†</td>
        </tr>
        <tr data-area="ä¸­å¤®åŒº" data-price="36800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-10-15","buyAcceptDate":"2024-10-22","contractDate":"2024-11-10","deliveryDate":"2024-12-15","currentStep":4}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-wait">å¼•æ¸¡å¾…</span></td>
          <td>ä¸­å¤®åŒºæ™´æµ·5ä¸ç›®</td>
          <td style="font-weight:600;">HARUMI FLAG PARK VILLAGE Tæ£Ÿ</td>
          <td>49éš</td>
          <td>2LDK</td>
          <td>84.86ã¡</td>
          <td class="price-cell">36,800ä¸‡å††</td>
          <td>1,433.6ä¸‡å††</td>
          <td>2025å¹´8æœˆ</td>
          <td>å‹ã©ã å¾’æ­©18åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="35800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-06-20","buyAcceptDate":"2024-06-27","contractDate":"2024-07-15","deliveryDate":"2024-08-20","startDate":"2024-08-25","completeDate":"2024-10-30","saleStartDate":"2024-11-05","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦4ä¸ç›®</td>
          <td style="font-weight:600;">èŠæµ¦ã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã‚±ãƒ¼ãƒ—ã‚¿ãƒ¯ãƒ¼</td>
          <td>46éš</td>
          <td>2LDK</td>
          <td>101.48ã¡</td>
          <td class="price-cell">35,800ä¸‡å††</td>
          <td>1,166.3ä¸‡å††</td>
          <td>2006å¹´12æœˆ</td>
          <td>ç”°ç”º å¾’æ­©13åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="35800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-09-05","buyAcceptDate":"2024-09-12","contractDate":"2024-09-30","deliveryDate":"2024-11-05","startDate":"2024-11-10","completeDate":"2024-12-20","currentStep":6}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-reno">ãƒªãƒãƒ™ä¸­</span></td>
          <td>æ¸¯åŒºç™½é‡‘1ä¸ç›®</td>
          <td style="font-weight:600;">ç™½é‡‘ã‚¶ãƒ»ã‚¹ã‚«ã‚¤</td>
          <td>12éš</td>
          <td>2LDK</td>
          <td>76.00ã¡</td>
          <td class="price-cell">35,800ä¸‡å††</td>
          <td>1,557.2ä¸‡å††</td>
          <td>2023å¹´2æœˆ</td>
          <td>ç™½é‡‘é«˜è¼ª å¾’æ­©3åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="34500" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-05-01","buyAcceptDate":"2024-05-08","contractDate":"2024-05-25","deliveryDate":"2024-06-30","startDate":"2024-07-05","completeDate":"2024-09-10","saleStartDate":"2024-09-15","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºå—éº»å¸ƒ1ä¸ç›®</td>
          <td style="font-weight:600;">ã‚¤ã‚¯ã‚·ã‚¯ã‚¹éº»å¸ƒåç•ª</td>
          <td>3éš</td>
          <td>3LDK</td>
          <td>114.38ã¡</td>
          <td class="price-cell">34,500ä¸‡å††</td>
          <td>997.2ä¸‡å††</td>
          <td>1989å¹´11æœˆ</td>
          <td>éº»å¸ƒåç•ª å¾’æ­©9åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="33800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-04-15","buyAcceptDate":"2024-04-22","contractDate":"2024-05-10","deliveryDate":"2024-06-15","startDate":"2024-06-20","completeDate":"2024-08-25","saleStartDate":"2024-08-30","applyDate":"2024-10-20","saleContractDate":"2024-11-10","saleDeliveryDate":"2024-12-20","currentStep":10}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-done">æˆç´„æ¸ˆ</span></td>
          <td>æ¸¯åŒºä¸‰ç”°1ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚³ãƒ¼ãƒˆéº»å¸ƒåç•ªã‚¶ã‚¿ãƒ¯ãƒ¼</td>
          <td>29éš</td>
          <td>2LDK</td>
          <td>67.25ã¡</td>
          <td class="price-cell">33,800ä¸‡å††</td>
          <td>1,661.5ä¸‡å††</td>
          <td>2010å¹´5æœˆ</td>
          <td>éº»å¸ƒåç•ª å¾’æ­©3åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="32800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-08-10","buyAcceptDate":"2024-08-17","contractDate":"2024-09-05","deliveryDate":"2024-10-10","startDate":"2024-10-15","completeDate":"2024-12-10","saleStartDate":"2024-12-15","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèµ¤å‚8ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ´ã‚§ãƒ¼ã‚¼ãƒ³ãƒˆèµ¤å‚æ–°å‚</td>
          <td>4éš</td>
          <td>2LDK</td>
          <td>70.17ã¡</td>
          <td class="price-cell">32,800ä¸‡å††</td>
          <td>1,545.3ä¸‡å††</td>
          <td>2001å¹´3æœˆ</td>
          <td>é’å±±ä¸€ä¸ç›® å¾’æ­©4åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="32800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-07-25","buyAcceptDate":"2024-08-01","contractDate":"2024-08-20","deliveryDate":"2024-09-25","startDate":"2024-09-30","completeDate":"2024-12-05","saleStartDate":"2024-12-10","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦2ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ–ãƒ©ãƒ³ã‚ºã‚¿ãƒ¯ãƒ¼èŠæµ¦</td>
          <td>26éš</td>
          <td>3LDK</td>
          <td>80.07ã¡</td>
          <td class="price-cell">32,800ä¸‡å††</td>
          <td>1,354.2ä¸‡å††</td>
          <td>2021å¹´8æœˆ</td>
          <td>ç”°ç”º å¾’æ­©9åˆ†</td>
        </tr>
        <tr data-area="æ¸‹è°·åŒº" data-price="31980" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-06-15","buyAcceptDate":"2024-06-22","contractDate":"2024-07-10","deliveryDate":"2024-08-15","startDate":"2024-08-20","completeDate":"2024-10-25","saleStartDate":"2024-10-30","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸‹è°·åŒºåºƒå°¾4ä¸ç›®</td>
          <td style="font-weight:600;">åºƒå°¾ã‚¬ãƒ¼ãƒ‡ãƒ³ãƒ’ãƒ«ã‚ºã‚¦ã‚¨ã‚¹ãƒˆãƒ’ãƒ«Kæ£Ÿ</td>
          <td>1éš</td>
          <td>3LDK</td>
          <td>90.73ã¡</td>
          <td class="price-cell">31,980ä¸‡å††</td>
          <td>1,165.3ä¸‡å††</td>
          <td>1985å¹´7æœˆ</td>
          <td>åºƒå°¾ å¾’æ­©5åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="29800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-09-20","buyAcceptDate":"2024-09-27","contractDate":"2024-10-15","deliveryDate":"2024-11-20","startDate":"2024-11-25","currentStep":5}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-reno">ãƒªãƒãƒ™ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦1ä¸ç›®</td>
          <td style="font-weight:600;">GLOBAL FRONT TOWER</td>
          <td>20éš</td>
          <td>2LDK</td>
          <td>83.88ã¡</td>
          <td class="price-cell">29,800ä¸‡å††</td>
          <td>1,174.5ä¸‡å††</td>
          <td>2015å¹´9æœˆ</td>
          <td>æ—¥ã®å‡º å¾’æ­©8åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="27800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-05-20","buyAcceptDate":"2024-05-27","contractDate":"2024-06-15","deliveryDate":"2024-07-20","startDate":"2024-07-25","completeDate":"2024-09-30","saleStartDate":"2024-10-05","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦4ä¸ç›®</td>
          <td style="font-weight:600;">èŠæµ¦ã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã‚°ãƒ­ãƒ¼ãƒ´ã‚¿ãƒ¯ãƒ¼</td>
          <td>46éš</td>
          <td>2LDK</td>
          <td>83.80ã¡</td>
          <td class="price-cell">27,800ä¸‡å††</td>
          <td>1,096.7ä¸‡å††</td>
          <td>2006å¹´11æœˆ</td>
          <td>ç”°ç”º å¾’æ­©9åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="26800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-08-05","buyAcceptDate":"2024-08-12","contractDate":"2024-08-30","deliveryDate":"2024-10-05","startDate":"2024-10-10","completeDate":"2024-12-15","saleStartDate":"2024-12-18","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºä¸‰ç”°2ä¸ç›®</td>
          <td style="font-weight:600;">ã‚¶ãƒ»ãƒ¬ã‚¸ãƒ‡ãƒ³ã‚¹ä¸‰ç”°</td>
          <td>2éš</td>
          <td>2LDK</td>
          <td>71.42ã¡</td>
          <td class="price-cell">26,800ä¸‡å††</td>
          <td>1,240.5ä¸‡å††</td>
          <td>2014å¹´11æœˆ</td>
          <td>èµ¤ç¾½æ©‹ å¾’æ­©6åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="25800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-07-01","buyAcceptDate":"2024-07-08","contractDate":"2024-07-25","deliveryDate":"2024-08-30","startDate":"2024-09-05","completeDate":"2024-11-10","saleStartDate":"2024-11-15","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºæµœæ¾ç”º1ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚³ãƒ¼ãƒˆæµœé›¢å®® ã‚¶ ã‚¿ãƒ¯ãƒ¼</td>
          <td>13éš</td>
          <td>2LDK</td>
          <td>55.07ã¡</td>
          <td class="price-cell">25,800ä¸‡å††</td>
          <td>1,548.8ä¸‡å††</td>
          <td>2019å¹´2æœˆ</td>
          <td>æµœæ¾ç”º å¾’æ­©5åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="25300" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-06-25","buyAcceptDate":"2024-07-02","contractDate":"2024-07-20","deliveryDate":"2024-08-25","startDate":"2024-08-30","completeDate":"2024-11-05","saleStartDate":"2024-11-10","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦4ä¸ç›®</td>
          <td style="font-weight:600;">èŠæµ¦ã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã‚±ãƒ¼ãƒ—ã‚¿ãƒ¯ãƒ¼</td>
          <td>32éš</td>
          <td>3LDK</td>
          <td>104.60ã¡</td>
          <td class="price-cell">25,300ä¸‡å††</td>
          <td>799.6ä¸‡å††</td>
          <td>2006å¹´10æœˆ</td>
          <td>ç”°ç”º å¾’æ­©13åˆ†</td>
        </tr>
        <tr data-area="æ¸¯åŒº" data-price="21800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-10-10","buyAcceptDate":"2024-10-17","contractDate":"2024-11-05","deliveryDate":"2024-12-10","startDate":"2024-12-15","currentStep":5}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-reno">ãƒªãƒãƒ™ä¸­</span></td>
          <td>æ¸¯åŒºèŠæµ¦4ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ—ãƒ©ã‚¦ãƒ‰ã‚¿ãƒ¯ãƒ¼èŠæµ¦</td>
          <td>23éš</td>
          <td>2LDK</td>
          <td>68.48ã¡</td>
          <td class="price-cell">21,800ä¸‡å††</td>
          <td>1,052.4ä¸‡å††</td>
          <td>2023å¹´1æœˆ</td>
          <td>ç”°ç”º å¾’æ­©12åˆ†</td>
        </tr>
        <tr data-area="ä¸­å¤®åŒº" data-price="19800" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-04-01","buyAcceptDate":"2024-04-08","contractDate":"2024-04-25","deliveryDate":"2024-05-30","startDate":"2024-06-05","completeDate":"2024-08-10","saleStartDate":"2024-08-15","applyDate":"2024-10-01","saleContractDate":"2024-10-20","currentStep":9}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-nego">å•†è«‡ä¸­</span></td>
          <td>ä¸­å¤®åŒºæ™´æµ·2ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚¿ãƒ¯ãƒ¼æ™´æµ·</td>
          <td>13éš</td>
          <td>3LDK</td>
          <td>77.61ã¡</td>
          <td class="price-cell">19,800ä¸‡å††</td>
          <td>843.4ä¸‡å††</td>
          <td>2019å¹´2æœˆ</td>
          <td>æœˆå³¶ å¾’æ­©11åˆ†</td>
        </tr>
        <tr data-area="ä¸­å¤®åŒº" data-price="16800" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-11-01","buyAcceptDate":"2024-11-08","contractDate":"2024-11-25","currentStep":3}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-contract">å¥‘ç´„ä¸­</span></td>
          <td>ä¸­å¤®åŒºæ™´æµ·5ä¸ç›®</td>
          <td style="font-weight:600;">HARUMI FLAG SUN VILLAGE Tæ£Ÿ</td>
          <td>41éš</td>
          <td>2LDK</td>
          <td>66.00ã¡</td>
          <td class="price-cell">16,800ä¸‡å††</td>
          <td>841.5ä¸‡å††</td>
          <td>2025å¹´8æœˆ</td>
          <td>å‹ã©ã å¾’æ­©18åˆ†</td>
        </tr>
        <tr data-area="æ–‡äº¬åŒº" data-price="16480" data-layout="3LDK" class="property-row"  data-schedule='{"buyDate":"2024-05-10","buyAcceptDate":"2024-05-17","contractDate":"2024-06-05","deliveryDate":"2024-07-10","startDate":"2024-07-15","completeDate":"2024-09-20","saleStartDate":"2024-09-25","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>æ–‡äº¬åŒºåƒçŸ³1ä¸ç›®</td>
          <td style="font-weight:600;">ã‚°ãƒ©ãƒ³ãƒ•ãƒ©ãƒƒãƒ„æ–‡äº¬ãƒ»åƒçŸ³</td>
          <td>2éš</td>
          <td>3LDK</td>
          <td>77.10ã¡</td>
          <td class="price-cell">16,480ä¸‡å††</td>
          <td>706.7ä¸‡å††</td>
          <td>2002å¹´4æœˆ</td>
          <td>åƒçŸ³ å¾’æ­©4åˆ†</td>
        </tr>
        <tr data-area="ä¸­å¤®åŒº" data-price="16480" data-layout="2LDK" class="property-row"  data-schedule='{"buyDate":"2024-06-05","buyAcceptDate":"2024-06-12","contractDate":"2024-06-30","deliveryDate":"2024-08-05","startDate":"2024-08-10","completeDate":"2024-10-15","saleStartDate":"2024-10-20","currentStep":7}'>
          <td class="expand-cell"><span class="expand-icon">â–¶</span></td>
          <td><span class="status-tag status-sale">è²©å£²ä¸­</span></td>
          <td>ä¸­å¤®åŒºæ™´æµ·2ä¸ç›®</td>
          <td style="font-weight:600;">ãƒ‘ãƒ¼ã‚¯ã‚¿ãƒ¯ãƒ¼æ™´æµ·</td>
          <td>17éš</td>
          <td>2LDK</td>
          <td>70.09ã¡</td>
          <td class="price-cell">16,480ä¸‡å††</td>
          <td>777.3ä¸‡å††</td>
          <td>2019å¹´2æœˆ</td>
          <td>æœˆå³¶ å¾’æ­©11åˆ†</td>
        </tr>
      </tbody>
    </table>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;padding-top:16px;border-top:1px solid var(--border);">
      <span style="font-size:0.85rem;color:var(--text-muted);" id="displayCount">å…¨30ä»¶ã‚’è¡¨ç¤º</span>
      <div style="font-size:0.8rem;color:var(--text-muted);">â€» REINSãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šï¼ˆæ ªï¼‰ã‚¼ãƒ‹ã‚¢ã‚¹ç‰©ä»¶ã‚’æŠ½å‡º</div>
    </div>
  </div>

  <!-- Row 6:æ‹…å½“è€…ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ -->
  <div class="card">
    <div class="card-header">
      <div class="card-title">ğŸ‘¥ æ‹…å½“è€…åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</div>
      <div class="card-actions">
        <button class="card-action-btn">ä»Šæœˆ</button>
        <button class="card-action-btn">å››åŠæœŸ</button>
        <button class="card-action-btn">å¹´é–“</button>
      </div>
    </div>
    <table>
      <thead>
        <tr>
          <th>æ‹…å½“è€…</th>
          <th>æ‹…å½“ç‰©ä»¶æ•°</th>
          <th>æˆç´„ä»¶æ•°</th>
          <th>æˆç´„ç‡</th>
          <th>ç·ç²—åˆ©</th>
          <th>å¹³å‡ç²—åˆ©ç‡</th>
          <th>å¹³å‡æˆç´„æ—¥æ•°</th>
          <th>è©•ä¾¡</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="font-weight:600;">ä½è—¤ å¥ä¸€</td>
          <td>8ä»¶</td>
          <td>6ä»¶</td>
          <td style="color:var(--success);font-weight:600;">75.0%</td>
          <td class="profit-cell">4.2å„„å††</td>
          <td style="color:var(--success);font-weight:600;">24.8%</td>
          <td>68æ—¥</td>
          <td><span style="background:#d1fae5;color:#065f46;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:600;">ğŸ† MVP</span></td>
        </tr>
        <tr>
          <td style="font-weight:600;">ç‹©é‡å†… è±Š</td>
          <td>7ä»¶</td>
          <td>5ä»¶</td>
          <td style="color:var(--success);font-weight:600;">71.4%</td>
          <td class="profit-cell">3.8å„„å††</td>
          <td style="color:var(--success);font-weight:600;">23.1%</td>
          <td>82æ—¥</td>
          <td><span style="background:#dbeafe;color:#1e40af;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:600;">â­ å„ªç§€</span></td>
        </tr>
        <tr>
          <td style="font-weight:600;">ç”°ä¸­ ç¾å’²</td>
          <td>7ä»¶</td>
          <td>4ä»¶</td>
          <td>57.1%</td>
          <td class="profit-cell">2.9å„„å††</td>
          <td>21.5%</td>
          <td>95æ—¥</td>
          <td><span style="background:#f3f4f6;color:#6b7280;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:600;">æ¨™æº–</span></td>
        </tr>
        <tr>
          <td style="font-weight:600;">éˆ´æœ¨ ä¸€éƒ</td>
          <td>6ä»¶</td>
          <td>3ä»¶</td>
          <td style="color:var(--warning);">50.0%</td>
          <td class="profit-cell">2.1å„„å††</td>
          <td>19.8%</td>
          <td>112æ—¥</td>
          <td><span style="background:#fef3c7;color:#92400e;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:600;">è¦æ”¹å–„</span></td>
        </tr>
        <tr>
          <td style="font-weight:600;">å±±æœ¬ å¤ªéƒ</td>
          <td>5ä»¶</td>
          <td>2ä»¶</td>
          <td style="color:var(--danger);">40.0%</td>
          <td class="profit-cell">1.5å„„å††</td>
          <td style="color:var(--danger);">16.2%</td>
          <td style="color:var(--danger);">145æ—¥</td>
          <td><span style="background:#fee2e2;color:#991b1b;padding:4px 10px;border-radius:20px;font-size:0.75rem;font-weight:600;">âš ï¸ æ³¨æ„</span></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Tooltip -->
<div class="tooltip" id="tooltip"></div>

<script>
// Period Filter
function setPeriod(btn, period) {
  document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  
  const today = new Date();
  let startDate = new Date();
  
  switch(period) {
    case 'month':
      startDate = new Date(today.getFullYear(), today.getMonth(), 1);
      break;
    case 'quarter':
      const quarter = Math.floor(today.getMonth() / 3);
      startDate = new Date(today.getFullYear(), quarter * 3, 1);
      break;
    case 'half':
      const half = today.getMonth() < 6 ? 0 : 6;
      startDate = new Date(today.getFullYear(), half, 1);
      break;
    case 'year':
      startDate = new Date(today.getFullYear(), 0, 1);
      break;
  }
  
  // Update date inputs
  document.querySelector('.date-range input:first-of-type').value = startDate.toISOString().split('T')[0];
}

// Tab switching
function showTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
}

// Tooltip functionality
const tooltip = document.getElementById('tooltip');

document.querySelectorAll('.bar').forEach(bar => {
  bar.addEventListener('mouseenter', (e) => {
    const value = bar.dataset.value;
    tooltip.textContent = value;
    tooltip.classList.add('visible');
  });
  
  bar.addEventListener('mousemove', (e) => {
    tooltip.style.left = e.pageX + 10 + 'px';
    tooltip.style.top = e.pageY - 30 + 'px';
  });
  
  bar.addEventListener('mouseleave', () => {
    tooltip.classList.remove('visible');
  });
});

document.querySelectorAll('.heatmap-cell').forEach(cell => {
  cell.addEventListener('mouseenter', (e) => {
    const count = cell.dataset.count;
    const profit = cell.dataset.profit;
    if (count !== '0') {
      tooltip.textContent = `${count}ä»¶ / ç²—åˆ©ç‡: ${profit}`;
      tooltip.classList.add('visible');
    }
  });
  
  cell.addEventListener('mousemove', (e) => {
    tooltip.style.left = e.pageX + 10 + 'px';
    tooltip.style.top = e.pageY - 30 + 'px';
  });
  
  cell.addEventListener('mouseleave', () => {
    tooltip.classList.remove('visible');
  });
});

document.querySelectorAll('.line-chart-dot').forEach(dot => {
  dot.addEventListener('mouseenter', (e) => {
    const months = ['7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
    const values = ['18.2%', '20.5%', '19.1%', '21.8%', '23.5%', '25.2%'];
    const index = Array.from(document.querySelectorAll('.line-chart-dot')).indexOf(dot);
    tooltip.textContent = `${months[index]}: ${values[index]}`;
    tooltip.classList.add('visible');
  });
  
  dot.addEventListener('mousemove', (e) => {
    tooltip.style.left = e.pageX + 10 + 'px';
    tooltip.style.top = e.pageY - 30 + 'px';
  });
  
  dot.addEventListener('mouseleave', () => {
    tooltip.classList.remove('visible');
  });
});

// Animate KPI progress bars on load
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.kpi-progress-bar').forEach(bar => {
    const width = bar.style.width;
    bar.style.width = '0';
    setTimeout(() => {
      bar.style.width = width;
    }, 500);
  });
});

// Filter state
let selectedFilters = {
  area: [],
  price: [],
  layout: []
};

// Toggle Filter Button
function toggleFilterBtn(btn) {
  const filterType = btn.dataset.filter;
  const value = btn.dataset.value;
  const container = btn.parentElement;
  const allBtn = container.querySelector('[data-value=""]');
  
  if (value === '') {
    // "ã™ã¹ã¦" clicked - clear other selections
    container.querySelectorAll('.filter-btn').forEach(b => {
      b.classList.remove('active', 'selected');
    });
    btn.classList.add('active');
    selectedFilters[filterType] = [];
  } else {
    // Specific filter clicked
    allBtn.classList.remove('active');
    
    if (btn.classList.contains('selected')) {
      // Deselect
      btn.classList.remove('selected');
      selectedFilters[filterType] = selectedFilters[filterType].filter(v => v !== value);
      
      // If nothing selected, activate "ã™ã¹ã¦"
      if (selectedFilters[filterType].length === 0) {
        allBtn.classList.add('active');
      }
    } else {
      // Select
      btn.classList.add('selected');
      selectedFilters[filterType].push(value);
    }
  }
  
  filterProperties();
}

// Property Filter Function
function filterProperties() {
  const rows = document.querySelectorAll('#propertyBody tr[data-area]');
  let visibleCount = 0;
  let totalPrice = 0;
  let totalTsubo = 0;
  let totalArea = 0;
  
  // Close all timelines when filtering
  document.querySelectorAll('.timeline-row').forEach(tr => tr.remove());
  document.querySelectorAll('#propertyBody tr.expanded').forEach(tr => tr.classList.remove('expanded'));
  
  rows.forEach(row => {
    const area = row.dataset.area;
    const price = parseInt(row.dataset.price);
    const layout = row.dataset.layout;
    
    // Area filter
    let showArea = selectedFilters.area.length === 0 || selectedFilters.area.includes(area);
    
    // Price filter
    let showPrice = true;
    if (selectedFilters.price.length > 0) {
      showPrice = selectedFilters.price.some(priceRange => {
        const limit = parseInt(priceRange);
        if (limit === 20000) return price <= 20000;
        if (limit === 30000) return price > 20000 && price <= 30000;
        if (limit === 50000) return price > 30000 && price <= 50000;
        if (limit === 99999) return price > 50000;
        return false;
      });
    }
    
    // Layout filter
    let showLayout = selectedFilters.layout.length === 0 || selectedFilters.layout.includes(layout);
    
    if (showArea && showPrice && showLayout) {
      row.style.display = '';
      visibleCount++;
      totalPrice += price;
      
      // Extract tsubo price from row (column index 8 with expand-cell and status column)
      const tsuboCell = row.cells[8].textContent.replace(/[,ä¸‡å††]/g, '');
      totalTsubo += parseFloat(tsuboCell) || 0;
      
      // Extract area from row (column index 6 with expand-cell and status column)
      const areaCell = row.cells[6].textContent.replace(/[ã¡]/g, '');
      totalArea += parseFloat(areaCell) || 0;
    } else {
      row.style.display = 'none';
    }
  });
  
  // Update summary
  document.getElementById('totalCount').textContent = visibleCount + 'ä»¶';
  document.getElementById('totalValue').textContent = (totalPrice / 10000).toFixed(1) + 'å„„å††';
  document.getElementById('avgPrice').textContent = visibleCount > 0 ? ((totalPrice / visibleCount) / 10000).toFixed(2) + 'å„„å††' : '-';
  document.getElementById('avgTsubo').textContent = visibleCount > 0 ? Math.round(totalTsubo / visibleCount).toLocaleString() + 'ä¸‡å††' : '-';
  document.getElementById('avgArea').textContent = visibleCount > 0 ? (totalArea / visibleCount).toFixed(1) + 'ã¡' : '-';
  
  // Update display count text
  const hasFilters = selectedFilters.area.length > 0 || selectedFilters.price.length > 0 || selectedFilters.layout.length > 0;
  document.getElementById('displayCount').textContent = hasFilters ? 
    visibleCount + 'ä»¶ã‚’è¡¨ç¤ºï¼ˆãƒ•ã‚£ãƒ«ã‚¿é©ç”¨ä¸­ï¼‰' : 
    'å…¨30ä»¶ã‚’è¡¨ç¤º';
}

// Sort Table Function
let sortDirection = {};
function sortTable(columnIndex) {
  const table = document.getElementById('propertyTable');
  const tbody = document.getElementById('propertyBody');
  const rows = Array.from(tbody.querySelectorAll('tr'));
  
  sortDirection[columnIndex] = !sortDirection[columnIndex];
  const direction = sortDirection[columnIndex] ? 1 : -1;
  
  rows.sort((a, b) => {
    let aVal = a.cells[columnIndex].textContent.trim();
    let bVal = b.cells[columnIndex].textContent.trim();
    
    // Handle price columns (remove commas and ä¸‡å††)
    if (columnIndex === 6 || columnIndex === 7) {
      aVal = parseFloat(aVal.replace(/[,ä¸‡å††]/g, '')) || 0;
      bVal = parseFloat(bVal.replace(/[,ä¸‡å††]/g, '')) || 0;
      return (aVal - bVal) * direction;
    }
    
    return aVal.localeCompare(bVal, 'ja') * direction;
  });
  
  rows.forEach(row => tbody.appendChild(row));
}

// Export CSV Function
function exportCSV() {
  const table = document.getElementById('propertyTable');
  const rows = table.querySelectorAll('tr');
  let csv = [];
  
  rows.forEach(row => {
    if (row.style.display !== 'none' && !row.classList.contains('timeline-row')) {
      const cols = row.querySelectorAll('td, th');
      const rowData = Array.from(cols).map(col => '"' + col.textContent.trim().replace(/"/g, '""') + '"');
      csv.push(rowData.join(','));
    }
  });
  
  const csvContent = '\uFEFF' + csv.join('\n');
  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'zenias_properties_' + new Date().toISOString().slice(0,10) + '.csv';
  link.click();
}

// Timeline Steps Definition
const timelineSteps = [
  { id: 'purchase_offer', label: 'è²·ä»˜', icon: 'ğŸ“', section: 'purchase' },
  { id: 'purchase_accept', label: 'è²·ä»˜æ‰¿è«¾', icon: 'âœ…', section: 'purchase' },
  { id: 'purchase_contract', label: 'å¥‘ç´„', icon: 'ğŸ“„', section: 'purchase' },
  { id: 'purchase_delivery', label: 'å¼•æ¸¡ã—', icon: 'ğŸ”‘', section: 'purchase' },
  { id: 'reno_start', label: 'ç€å·¥', icon: 'ğŸ”¨', section: 'renovation' },
  { id: 'reno_complete', label: 'å®Œå·¥', icon: 'ğŸ ', section: 'renovation' },
  { id: 'sale_start', label: 'è²©å£²é–‹å§‹', icon: 'ğŸ·ï¸', section: 'sale' },
  { id: 'sale_application', label: 'ç”³è¾¼', icon: 'ğŸ“‹', section: 'sale' },
  { id: 'sale_contract', label: 'å¥‘ç´„', icon: 'ğŸ“„', section: 'sale' },
  { id: 'sale_delivery', label: 'å¼•æ¸¡ã—', icon: 'ğŸ‰', section: 'sale' }
];

// Generate random dates for demo
function generateTimelineDates(propertyIndex) {
  const baseDate = new Date('2024-06-01');
  baseDate.setDate(baseDate.getDate() + propertyIndex * 15); // Stagger by property
  
  const dates = [];
  let currentDate = new Date(baseDate);
  
  // Generate dates for each step
  const intervals = [0, 3, 14, 30, 45, 90, 100, null, null, null]; // Days between steps
  
  intervals.forEach((interval, i) => {
    if (interval !== null) {
      currentDate = new Date(currentDate);
      currentDate.setDate(currentDate.getDate() + interval);
      dates.push(currentDate.toLocaleDateString('ja-JP', { month: 'short', day: 'numeric' }));
    } else {
      dates.push(null);
    }
  });
  
  return dates;
}

// Get current step based on status (for demo, all are "è²©å£²ä¸­" = step 7)
function getCurrentStep(status) {
  // è²©å£²ä¸­ = è²©å£²é–‹å§‹å®Œäº†ã€ç”³è¾¼å¾…ã¡
  return 6; // Index of è²©å£²é–‹å§‹ (0-based)
}

// Create timeline HTML
function createTimelineHTML(propertyIndex, propertyName) {
  const dates = generateTimelineDates(propertyIndex);
  const currentStep = 6; // è²©å£²é–‹å§‹æ¸ˆã¿
  
  let html = `
    <div class="timeline-container">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
        <div style="font-size:0.95rem;font-weight:600;color:var(--text);">
          ğŸ“… ${propertyName} - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        </div>
        <div style="display:flex;gap:16px;font-size:0.75rem;">
          <span style="display:flex;align-items:center;gap:4px;">
            <span style="width:12px;height:12px;background:var(--success);border-radius:50%;"></span> å®Œäº†
          </span>
          <span style="display:flex;align-items:center;gap:4px;">
            <span style="width:12px;height:12px;background:var(--accent);border-radius:50%;"></span> ç¾åœ¨
          </span>
          <span style="display:flex;align-items:center;gap:4px;">
            <span style="width:12px;height:12px;background:#e2e8f0;border-radius:50%;"></span> äºˆå®š
          </span>
        </div>
      </div>
      <div style="display:flex;gap:8px;margin-bottom:12px;">
        <span class="timeline-section-label section-purchase" style="position:static;">ğŸ¢ ä»•å…¥ã‚Œ</span>
        <span class="timeline-section-label section-renovation" style="position:static;">ğŸ”§ ãƒªãƒãƒ™</span>
        <span class="timeline-section-label section-sale" style="position:static;">ğŸ’° è²©å£²</span>
      </div>
      <div class="timeline">
  `;
  
  timelineSteps.forEach((step, index) => {
    let status = 'pending';
    if (index < currentStep) status = 'completed';
    else if (index === currentStep) status = 'current';
    
    const date = dates[index] || 'â€”';
    
    html += `
      <div class="timeline-item ${status}">
        <div class="timeline-icon">${status === 'completed' ? 'âœ“' : step.icon}</div>
        <div class="timeline-label">${step.label}</div>
        <div class="timeline-date">${date}</div>
      </div>
    `;
  });
  
  html += `
      </div>
    </div>
  `;
  
  return html;
}

// Toggle timeline dropdown
function toggleTimeline(row, index) {
  const existingTimeline = row.nextElementSibling;

  // If clicking the same row that's already open, close it
  if (existingTimeline && existingTimeline.classList.contains('timeline-row')) {
    existingTimeline.remove();
    row.classList.remove('expanded');
    return;
  }

  // Close all other timelines
  document.querySelectorAll('.timeline-row').forEach(tr => {
    tr.previousElementSibling?.classList.remove('expanded');
    tr.remove();
  });

  // Create new timeline row
  const propertyName = row.cells[3].textContent;
  const timelineRow = document.createElement('tr');
  timelineRow.className = 'timeline-row show';
  timelineRow.innerHTML = `<td colspan="11">${createTimelineHTML(index, propertyName)}</td>`;

  row.classList.add('expanded');
  row.after(timelineRow);
}

// Initialize property row click handlers
document.addEventListener('DOMContentLoaded', () => {
  const rows = document.querySelectorAll('#propertyBody tr[data-area]');
  rows.forEach((row, index) => {
    // Handle both touch and click
    const handleInteraction = (e) => {
      // Prevent default only for touch to avoid scroll issues
      if (e.type === 'touchend') {
        e.preventDefault();
      }
      toggleTimeline(row, index);
    };
    
    row.addEventListener('click', handleInteraction);
    row.addEventListener('touchend', handleInteraction);
    
    // Prevent double-tap zoom on iOS
    row.style.touchAction = 'manipulation';
    row.style.webkitTapHighlightColor = 'transparent';
    row.style.userSelect = 'none';
    row.style.webkitUserSelect = 'none';
  });
  
  // Make tabs touch-friendly
  document.querySelectorAll('.tab').forEach(tab => {
    tab.style.touchAction = 'manipulation';
    tab.style.webkitTapHighlightColor = 'transparent';
  });
  
  // Make filter buttons touch-friendly
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.style.touchAction = 'manipulation';
    btn.style.webkitTapHighlightColor = 'transparent';
  });
  
  // Make period buttons touch-friendly
  document.querySelectorAll('.period-btn').forEach(btn => {
    btn.style.touchAction = 'manipulation';
    btn.style.webkitTapHighlightColor = 'transparent';
  });
  
  // Initialize KPI progress bars animation
  document.querySelectorAll('.kpi-progress-bar').forEach(bar => {
    const width = bar.style.width;
    bar.style.width = '0';
    setTimeout(() => {
      bar.style.width = width;
    }, 500);
  });
});
</script>
</body>
</html>
